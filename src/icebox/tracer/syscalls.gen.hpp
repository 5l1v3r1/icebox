#pragma once

#include "core.hpp"
#include "tracer.hpp"
#include "types.hpp"
#include "nt/nt.hpp"
#include "nt/nt64.hpp"

#include <functional>

namespace nt64
{
    using on_NtAcceptConnectPort_fn                                = std::function<NTSTATUS(PHANDLE, PVOID, PPORT_MESSAGE, BOOLEAN, PPORT_VIEW, PREMOTE_PORT_VIEW)>;
    using on_NtAccessCheckAndAuditAlarm_fn                         = std::function<NTSTATUS(PUNICODE_STRING, PVOID, PUNICODE_STRING, PUNICODE_STRING, PSECURITY_DESCRIPTOR, ACCESS_MASK, PGENERIC_MAPPING, BOOLEAN, PACCESS_MASK, PNTSTATUS, PBOOLEAN)>;
    using on_NtAccessCheckByTypeAndAuditAlarm_fn                   = std::function<NTSTATUS(PUNICODE_STRING, PVOID, PUNICODE_STRING, PUNICODE_STRING, PSECURITY_DESCRIPTOR, PSID, ACCESS_MASK, AUDIT_EVENT_TYPE, ULONG, POBJECT_TYPE_LIST, ULONG, PGENERIC_MAPPING, BOOLEAN, PACCESS_MASK, PNTSTATUS, PBOOLEAN)>;
    using on_NtAccessCheckByType_fn                                = std::function<NTSTATUS(PSECURITY_DESCRIPTOR, PSID, HANDLE, ACCESS_MASK, POBJECT_TYPE_LIST, ULONG, PGENERIC_MAPPING, PPRIVILEGE_SET, PULONG, PACCESS_MASK, PNTSTATUS)>;
    using on_NtAccessCheckByTypeResultListAndAuditAlarmByHandle_fn = std::function<NTSTATUS(PUNICODE_STRING, PVOID, HANDLE, PUNICODE_STRING, PUNICODE_STRING, PSECURITY_DESCRIPTOR, PSID, ACCESS_MASK, AUDIT_EVENT_TYPE, ULONG, POBJECT_TYPE_LIST, ULONG, PGENERIC_MAPPING, BOOLEAN, PACCESS_MASK, PNTSTATUS, PBOOLEAN)>;
    using on_NtAccessCheckByTypeResultListAndAuditAlarm_fn         = std::function<NTSTATUS(PUNICODE_STRING, PVOID, PUNICODE_STRING, PUNICODE_STRING, PSECURITY_DESCRIPTOR, PSID, ACCESS_MASK, AUDIT_EVENT_TYPE, ULONG, POBJECT_TYPE_LIST, ULONG, PGENERIC_MAPPING, BOOLEAN, PACCESS_MASK, PNTSTATUS, PBOOLEAN)>;
    using on_NtAccessCheckByTypeResultList_fn                      = std::function<NTSTATUS(PSECURITY_DESCRIPTOR, PSID, HANDLE, ACCESS_MASK, POBJECT_TYPE_LIST, ULONG, PGENERIC_MAPPING, PPRIVILEGE_SET, PULONG, PACCESS_MASK, PNTSTATUS)>;
    using on_NtAccessCheck_fn                                      = std::function<NTSTATUS(PSECURITY_DESCRIPTOR, HANDLE, ACCESS_MASK, PGENERIC_MAPPING, PPRIVILEGE_SET, PULONG, PACCESS_MASK, PNTSTATUS)>;
    using on_NtAddAtom_fn                                          = std::function<NTSTATUS(PWSTR, ULONG, PRTL_ATOM)>;
    using on_NtAddBootEntry_fn                                     = std::function<NTSTATUS(PBOOT_ENTRY, PULONG)>;
    using on_NtAddDriverEntry_fn                                   = std::function<NTSTATUS(PEFI_DRIVER_ENTRY, PULONG)>;
    using on_NtAdjustGroupsToken_fn                                = std::function<NTSTATUS(HANDLE, BOOLEAN, PTOKEN_GROUPS, ULONG, PTOKEN_GROUPS, PULONG)>;
    using on_NtAdjustPrivilegesToken_fn                            = std::function<NTSTATUS(HANDLE, BOOLEAN, PTOKEN_PRIVILEGES, ULONG, PTOKEN_PRIVILEGES, PULONG)>;
    using on_NtAlertResumeThread_fn                                = std::function<NTSTATUS(HANDLE, PULONG)>;
    using on_NtAlertThread_fn                                      = std::function<NTSTATUS(HANDLE)>;
    using on_NtAllocateLocallyUniqueId_fn                          = std::function<NTSTATUS(PLUID)>;
    using on_NtAllocateReserveObject_fn                            = std::function<NTSTATUS(PHANDLE, POBJECT_ATTRIBUTES, MEMORY_RESERVE_TYPE)>;
    using on_NtAllocateUserPhysicalPages_fn                        = std::function<NTSTATUS(HANDLE, PULONG_PTR, PULONG_PTR)>;
    using on_NtAllocateUuids_fn                                    = std::function<NTSTATUS(PULARGE_INTEGER, PULONG, PULONG, PCHAR)>;
    using on_NtAllocateVirtualMemory_fn                            = std::function<NTSTATUS(HANDLE, PVOID, ULONG_PTR, PSIZE_T, ULONG, ULONG)>;
    using on_NtAlpcAcceptConnectPort_fn                            = std::function<NTSTATUS(PHANDLE, HANDLE, ULONG, POBJECT_ATTRIBUTES, PALPC_PORT_ATTRIBUTES, PVOID, PPORT_MESSAGE, PALPC_MESSAGE_ATTRIBUTES, BOOLEAN)>;
    using on_NtAlpcCancelMessage_fn                                = std::function<NTSTATUS(HANDLE, ULONG, PALPC_CONTEXT_ATTR)>;
    using on_NtAlpcConnectPort_fn                                  = std::function<NTSTATUS(PHANDLE, PUNICODE_STRING, POBJECT_ATTRIBUTES, PALPC_PORT_ATTRIBUTES, ULONG, PSID, PPORT_MESSAGE, PULONG, PALPC_MESSAGE_ATTRIBUTES, PALPC_MESSAGE_ATTRIBUTES, PLARGE_INTEGER)>;
    using on_NtAlpcCreatePort_fn                                   = std::function<NTSTATUS(PHANDLE, POBJECT_ATTRIBUTES, PALPC_PORT_ATTRIBUTES)>;
    using on_NtAlpcCreatePortSection_fn                            = std::function<NTSTATUS(HANDLE, ULONG, HANDLE, SIZE_T, PALPC_HANDLE, PSIZE_T)>;
    using on_NtAlpcCreateResourceReserve_fn                        = std::function<NTSTATUS(HANDLE, ULONG, SIZE_T, PALPC_HANDLE)>;
    using on_NtAlpcCreateSectionView_fn                            = std::function<NTSTATUS(HANDLE, ULONG, PALPC_DATA_VIEW_ATTR)>;
    using on_NtAlpcCreateSecurityContext_fn                        = std::function<NTSTATUS(HANDLE, ULONG, PALPC_SECURITY_ATTR)>;
    using on_NtAlpcDeletePortSection_fn                            = std::function<NTSTATUS(HANDLE, ULONG, ALPC_HANDLE)>;
    using on_NtAlpcDeleteResourceReserve_fn                        = std::function<NTSTATUS(HANDLE, ULONG, ALPC_HANDLE)>;
    using on_NtAlpcDeleteSectionView_fn                            = std::function<NTSTATUS(HANDLE, ULONG, PVOID)>;
    using on_NtAlpcDeleteSecurityContext_fn                        = std::function<NTSTATUS(HANDLE, ULONG, ALPC_HANDLE)>;
    using on_NtAlpcDisconnectPort_fn                               = std::function<NTSTATUS(HANDLE, ULONG)>;
    using on_NtAlpcImpersonateClientOfPort_fn                      = std::function<NTSTATUS(HANDLE, PPORT_MESSAGE, PVOID)>;
    using on_NtAlpcOpenSenderProcess_fn                            = std::function<NTSTATUS(PHANDLE, HANDLE, PPORT_MESSAGE, ULONG, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtAlpcOpenSenderThread_fn                             = std::function<NTSTATUS(PHANDLE, HANDLE, PPORT_MESSAGE, ULONG, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtAlpcQueryInformation_fn                             = std::function<NTSTATUS(HANDLE, ALPC_PORT_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtAlpcQueryInformationMessage_fn                      = std::function<NTSTATUS(HANDLE, PPORT_MESSAGE, ALPC_MESSAGE_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtAlpcRevokeSecurityContext_fn                        = std::function<NTSTATUS(HANDLE, ULONG, ALPC_HANDLE)>;
    using on_NtAlpcSendWaitReceivePort_fn                          = std::function<NTSTATUS(HANDLE, ULONG, PPORT_MESSAGE, PALPC_MESSAGE_ATTRIBUTES, PPORT_MESSAGE, PULONG, PALPC_MESSAGE_ATTRIBUTES, PLARGE_INTEGER)>;
    using on_NtAlpcSetInformation_fn                               = std::function<NTSTATUS(HANDLE, ALPC_PORT_INFORMATION_CLASS, PVOID, ULONG)>;
    using on_NtApphelpCacheControl_fn                              = std::function<NTSTATUS(APPHELPCOMMAND, PVOID)>;
    using on_NtAreMappedFilesTheSame_fn                            = std::function<NTSTATUS(PVOID, PVOID)>;
    using on_NtAssignProcessToJobObject_fn                         = std::function<NTSTATUS(HANDLE, HANDLE)>;
    using on_NtCancelIoFileEx_fn                                   = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK, PIO_STATUS_BLOCK)>;
    using on_NtCancelIoFile_fn                                     = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK)>;
    using on_NtCancelSynchronousIoFile_fn                          = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK, PIO_STATUS_BLOCK)>;
    using on_NtCancelTimer_fn                                      = std::function<NTSTATUS(HANDLE, PBOOLEAN)>;
    using on_NtClearEvent_fn                                       = std::function<NTSTATUS(HANDLE)>;
    using on_NtClose_fn                                            = std::function<NTSTATUS(HANDLE)>;
    using on_NtCloseObjectAuditAlarm_fn                            = std::function<NTSTATUS(PUNICODE_STRING, PVOID, BOOLEAN)>;
    using on_NtCommitComplete_fn                                   = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtCommitEnlistment_fn                                 = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtCommitTransaction_fn                                = std::function<NTSTATUS(HANDLE, BOOLEAN)>;
    using on_NtCompactKeys_fn                                      = std::function<NTSTATUS(ULONG, HANDLE)>;
    using on_NtCompareTokens_fn                                    = std::function<NTSTATUS(HANDLE, HANDLE, PBOOLEAN)>;
    using on_NtCompleteConnectPort_fn                              = std::function<NTSTATUS(HANDLE)>;
    using on_NtCompressKey_fn                                      = std::function<NTSTATUS(HANDLE)>;
    using on_NtConnectPort_fn                                      = std::function<NTSTATUS(PHANDLE, PUNICODE_STRING, PSECURITY_QUALITY_OF_SERVICE, PPORT_VIEW, PREMOTE_PORT_VIEW, PULONG, PVOID, PULONG)>;
    using on_NtContinue_fn                                         = std::function<NTSTATUS(PCONTEXT, BOOLEAN)>;
    using on_NtCreateDebugObject_fn                                = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, ULONG)>;
    using on_NtCreateDirectoryObject_fn                            = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtCreateEnlistment_fn                                 = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, HANDLE, HANDLE, POBJECT_ATTRIBUTES, ULONG, NOTIFICATION_MASK, PVOID)>;
    using on_NtCreateEvent_fn                                      = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, EVENT_TYPE, BOOLEAN)>;
    using on_NtCreateEventPair_fn                                  = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtCreateFile_fn                                       = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PIO_STATUS_BLOCK, PLARGE_INTEGER, ULONG, ULONG, ULONG, ULONG, PVOID, ULONG)>;
    using on_NtCreateIoCompletion_fn                               = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, ULONG)>;
    using on_NtCreateJobObject_fn                                  = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtCreateJobSet_fn                                     = std::function<NTSTATUS(ULONG, PJOB_SET_ARRAY, ULONG)>;
    using on_NtCreateKeyedEvent_fn                                 = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, ULONG)>;
    using on_NtCreateKey_fn                                        = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, ULONG, PUNICODE_STRING, ULONG, PULONG)>;
    using on_NtCreateKeyTransacted_fn                              = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, ULONG, PUNICODE_STRING, ULONG, HANDLE, PULONG)>;
    using on_NtCreateMailslotFile_fn                               = std::function<NTSTATUS(PHANDLE, ULONG, POBJECT_ATTRIBUTES, PIO_STATUS_BLOCK, ULONG, ULONG, ULONG, PLARGE_INTEGER)>;
    using on_NtCreateMutant_fn                                     = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, BOOLEAN)>;
    using on_NtCreateNamedPipeFile_fn                              = std::function<NTSTATUS(PHANDLE, ULONG, POBJECT_ATTRIBUTES, PIO_STATUS_BLOCK, ULONG, ULONG, ULONG, ULONG, ULONG, ULONG, ULONG, ULONG, ULONG, PLARGE_INTEGER)>;
    using on_NtCreatePagingFile_fn                                 = std::function<NTSTATUS(PUNICODE_STRING, PLARGE_INTEGER, PLARGE_INTEGER, ULONG)>;
    using on_NtCreatePort_fn                                       = std::function<NTSTATUS(PHANDLE, POBJECT_ATTRIBUTES, ULONG, ULONG, ULONG)>;
    using on_NtCreatePrivateNamespace_fn                           = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PVOID)>;
    using on_NtCreateProcessEx_fn                                  = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, HANDLE, ULONG, HANDLE, HANDLE, HANDLE, ULONG)>;
    using on_NtCreateProcess_fn                                    = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, HANDLE, BOOLEAN, HANDLE, HANDLE, HANDLE)>;
    using on_NtCreateProfileEx_fn                                  = std::function<NTSTATUS(PHANDLE, HANDLE, PVOID, SIZE_T, ULONG, PULONG, ULONG, KPROFILE_SOURCE, ULONG, PGROUP_AFFINITY)>;
    using on_NtCreateProfile_fn                                    = std::function<NTSTATUS(PHANDLE, HANDLE, PVOID, SIZE_T, ULONG, PULONG, ULONG, KPROFILE_SOURCE, KAFFINITY)>;
    using on_NtCreateResourceManager_fn                            = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, HANDLE, LPGUID, POBJECT_ATTRIBUTES, ULONG, PUNICODE_STRING)>;
    using on_NtCreateSection_fn                                    = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PLARGE_INTEGER, ULONG, ULONG, HANDLE)>;
    using on_NtCreateSemaphore_fn                                  = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, LONG, LONG)>;
    using on_NtCreateSymbolicLinkObject_fn                         = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PUNICODE_STRING)>;
    using on_NtCreateThreadEx_fn                                   = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, HANDLE, PVOID, PVOID, ULONG, ULONG_PTR, SIZE_T, SIZE_T, PPS_ATTRIBUTE_LIST)>;
    using on_NtCreateThread_fn                                     = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, HANDLE, PCLIENT_ID, PCONTEXT, PINITIAL_TEB, BOOLEAN)>;
    using on_NtCreateTimer_fn                                      = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, TIMER_TYPE)>;
    using on_NtCreateToken_fn                                      = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, TOKEN_TYPE, PLUID, PLARGE_INTEGER, PTOKEN_USER, PTOKEN_GROUPS, PTOKEN_PRIVILEGES, PTOKEN_OWNER, PTOKEN_PRIMARY_GROUP, PTOKEN_DEFAULT_DACL, PTOKEN_SOURCE)>;
    using on_NtCreateTransactionManager_fn                         = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PUNICODE_STRING, ULONG, ULONG)>;
    using on_NtCreateTransaction_fn                                = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, LPGUID, HANDLE, ULONG, ULONG, ULONG, PLARGE_INTEGER, PUNICODE_STRING)>;
    using on_NtCreateUserProcess_fn                                = std::function<NTSTATUS(PHANDLE, PHANDLE, ACCESS_MASK, ACCESS_MASK, POBJECT_ATTRIBUTES, POBJECT_ATTRIBUTES, ULONG, ULONG, PRTL_USER_PROCESS_PARAMETERS, PPROCESS_CREATE_INFO, PPROCESS_ATTRIBUTE_LIST)>;
    using on_NtCreateWaitablePort_fn                               = std::function<NTSTATUS(PHANDLE, POBJECT_ATTRIBUTES, ULONG, ULONG, ULONG)>;
    using on_NtCreateWorkerFactory_fn                              = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, HANDLE, HANDLE, PVOID, PVOID, ULONG, SIZE_T, SIZE_T)>;
    using on_NtDebugActiveProcess_fn                               = std::function<NTSTATUS(HANDLE, HANDLE)>;
    using on_NtDebugContinue_fn                                    = std::function<NTSTATUS(HANDLE, PCLIENT_ID, NTSTATUS)>;
    using on_NtDelayExecution_fn                                   = std::function<NTSTATUS(BOOLEAN, PLARGE_INTEGER)>;
    using on_NtDeleteAtom_fn                                       = std::function<NTSTATUS(RTL_ATOM)>;
    using on_NtDeleteBootEntry_fn                                  = std::function<NTSTATUS(ULONG)>;
    using on_NtDeleteDriverEntry_fn                                = std::function<NTSTATUS(ULONG)>;
    using on_NtDeleteFile_fn                                       = std::function<NTSTATUS(POBJECT_ATTRIBUTES)>;
    using on_NtDeleteKey_fn                                        = std::function<NTSTATUS(HANDLE)>;
    using on_NtDeleteObjectAuditAlarm_fn                           = std::function<NTSTATUS(PUNICODE_STRING, PVOID, BOOLEAN)>;
    using on_NtDeletePrivateNamespace_fn                           = std::function<NTSTATUS(HANDLE)>;
    using on_NtDeleteValueKey_fn                                   = std::function<NTSTATUS(HANDLE, PUNICODE_STRING)>;
    using on_NtDeviceIoControlFile_fn                              = std::function<NTSTATUS(HANDLE, HANDLE, PIO_APC_ROUTINE, PVOID, PIO_STATUS_BLOCK, ULONG, PVOID, ULONG, PVOID, ULONG)>;
    using on_NtDisplayString_fn                                    = std::function<NTSTATUS(PUNICODE_STRING)>;
    using on_NtDrawText_fn                                         = std::function<NTSTATUS(PUNICODE_STRING)>;
    using on_NtDuplicateObject_fn                                  = std::function<NTSTATUS(HANDLE, HANDLE, HANDLE, PHANDLE, ACCESS_MASK, ULONG, ULONG)>;
    using on_NtDuplicateToken_fn                                   = std::function<NTSTATUS(HANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, BOOLEAN, TOKEN_TYPE, PHANDLE)>;
    using on_NtEnumerateBootEntries_fn                             = std::function<NTSTATUS(PVOID, PULONG)>;
    using on_NtEnumerateDriverEntries_fn                           = std::function<NTSTATUS(PVOID, PULONG)>;
    using on_NtEnumerateKey_fn                                     = std::function<NTSTATUS(HANDLE, ULONG, KEY_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtEnumerateSystemEnvironmentValuesEx_fn               = std::function<NTSTATUS(ULONG, PVOID, PULONG)>;
    using on_NtEnumerateTransactionObject_fn                       = std::function<NTSTATUS(HANDLE, KTMOBJECT_TYPE, PKTMOBJECT_CURSOR, ULONG, PULONG)>;
    using on_NtEnumerateValueKey_fn                                = std::function<NTSTATUS(HANDLE, ULONG, KEY_VALUE_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtExtendSection_fn                                    = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtFilterToken_fn                                      = std::function<NTSTATUS(HANDLE, ULONG, PTOKEN_GROUPS, PTOKEN_PRIVILEGES, PTOKEN_GROUPS, PHANDLE)>;
    using on_NtFindAtom_fn                                         = std::function<NTSTATUS(PWSTR, ULONG, PRTL_ATOM)>;
    using on_NtFlushBuffersFile_fn                                 = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK)>;
    using on_NtFlushInstallUILanguage_fn                           = std::function<NTSTATUS(LANGID, ULONG)>;
    using on_NtFlushInstructionCache_fn                            = std::function<NTSTATUS(HANDLE, PVOID, SIZE_T)>;
    using on_NtFlushKey_fn                                         = std::function<NTSTATUS(HANDLE)>;
    using on_NtFlushVirtualMemory_fn                               = std::function<NTSTATUS(HANDLE, PVOID, PSIZE_T, PIO_STATUS_BLOCK)>;
    using on_NtFreeUserPhysicalPages_fn                            = std::function<NTSTATUS(HANDLE, PULONG_PTR, PULONG_PTR)>;
    using on_NtFreeVirtualMemory_fn                                = std::function<NTSTATUS(HANDLE, PVOID, PSIZE_T, ULONG)>;
    using on_NtFreezeRegistry_fn                                   = std::function<NTSTATUS(ULONG)>;
    using on_NtFreezeTransactions_fn                               = std::function<NTSTATUS(PLARGE_INTEGER, PLARGE_INTEGER)>;
    using on_NtFsControlFile_fn                                    = std::function<NTSTATUS(HANDLE, HANDLE, PIO_APC_ROUTINE, PVOID, PIO_STATUS_BLOCK, ULONG, PVOID, ULONG, PVOID, ULONG)>;
    using on_NtGetContextThread_fn                                 = std::function<NTSTATUS(HANDLE, PCONTEXT)>;
    using on_NtGetDevicePowerState_fn                              = std::function<NTSTATUS(HANDLE, DEVICE_POWER_STATE)>;
    using on_NtGetMUIRegistryInfo_fn                               = std::function<NTSTATUS(ULONG, PULONG, PVOID)>;
    using on_NtGetNextProcess_fn                                   = std::function<NTSTATUS(HANDLE, ACCESS_MASK, ULONG, ULONG, PHANDLE)>;
    using on_NtGetNextThread_fn                                    = std::function<NTSTATUS(HANDLE, HANDLE, ACCESS_MASK, ULONG, ULONG, PHANDLE)>;
    using on_NtGetNlsSectionPtr_fn                                 = std::function<NTSTATUS(ULONG, ULONG, PVOID, PVOID, PULONG)>;
    using on_NtGetNotificationResourceManager_fn                   = std::function<NTSTATUS(HANDLE, PTRANSACTION_NOTIFICATION, ULONG, PLARGE_INTEGER, PULONG, ULONG, ULONG_PTR)>;
    using on_NtGetPlugPlayEvent_fn                                 = std::function<NTSTATUS(HANDLE, PVOID, PPLUGPLAY_EVENT_BLOCK, ULONG)>;
    using on_NtGetWriteWatch_fn                                    = std::function<NTSTATUS(HANDLE, ULONG, PVOID, SIZE_T, PVOID, PULONG_PTR, PULONG)>;
    using on_NtImpersonateAnonymousToken_fn                        = std::function<NTSTATUS(HANDLE)>;
    using on_NtImpersonateClientOfPort_fn                          = std::function<NTSTATUS(HANDLE, PPORT_MESSAGE)>;
    using on_NtImpersonateThread_fn                                = std::function<NTSTATUS(HANDLE, HANDLE, PSECURITY_QUALITY_OF_SERVICE)>;
    using on_NtInitializeNlsFiles_fn                               = std::function<NTSTATUS(PVOID, PLCID, PLARGE_INTEGER)>;
    using on_NtInitializeRegistry_fn                               = std::function<NTSTATUS(USHORT)>;
    using on_NtInitiatePowerAction_fn                              = std::function<NTSTATUS(POWER_ACTION, SYSTEM_POWER_STATE, ULONG, BOOLEAN)>;
    using on_NtIsProcessInJob_fn                                   = std::function<NTSTATUS(HANDLE, HANDLE)>;
    using on_NtListenPort_fn                                       = std::function<NTSTATUS(HANDLE, PPORT_MESSAGE)>;
    using on_NtLoadDriver_fn                                       = std::function<NTSTATUS(PUNICODE_STRING)>;
    using on_NtLoadKey2_fn                                         = std::function<NTSTATUS(POBJECT_ATTRIBUTES, POBJECT_ATTRIBUTES, ULONG)>;
    using on_NtLoadKeyEx_fn                                        = std::function<NTSTATUS(POBJECT_ATTRIBUTES, POBJECT_ATTRIBUTES, ULONG, HANDLE)>;
    using on_NtLoadKey_fn                                          = std::function<NTSTATUS(POBJECT_ATTRIBUTES, POBJECT_ATTRIBUTES)>;
    using on_NtLockFile_fn                                         = std::function<NTSTATUS(HANDLE, HANDLE, PIO_APC_ROUTINE, PVOID, PIO_STATUS_BLOCK, PLARGE_INTEGER, PLARGE_INTEGER, ULONG, BOOLEAN, BOOLEAN)>;
    using on_NtLockProductActivationKeys_fn                        = std::function<NTSTATUS(ULONG, ULONG)>;
    using on_NtLockRegistryKey_fn                                  = std::function<NTSTATUS(HANDLE)>;
    using on_NtLockVirtualMemory_fn                                = std::function<NTSTATUS(HANDLE, PVOID, PSIZE_T, ULONG)>;
    using on_NtMakePermanentObject_fn                              = std::function<NTSTATUS(HANDLE)>;
    using on_NtMakeTemporaryObject_fn                              = std::function<NTSTATUS(HANDLE)>;
    using on_NtMapCMFModule_fn                                     = std::function<NTSTATUS(ULONG, ULONG, PULONG, PULONG, PULONG, PVOID)>;
    using on_NtMapUserPhysicalPages_fn                             = std::function<NTSTATUS(PVOID, ULONG_PTR, PULONG_PTR)>;
    using on_NtMapUserPhysicalPagesScatter_fn                      = std::function<NTSTATUS(PVOID, ULONG_PTR, PULONG_PTR)>;
    using on_NtMapViewOfSection_fn                                 = std::function<NTSTATUS(HANDLE, HANDLE, PVOID, ULONG_PTR, SIZE_T, PLARGE_INTEGER, PSIZE_T, SECTION_INHERIT, ULONG, WIN32_PROTECTION_MASK)>;
    using on_NtModifyBootEntry_fn                                  = std::function<NTSTATUS(PBOOT_ENTRY)>;
    using on_NtModifyDriverEntry_fn                                = std::function<NTSTATUS(PEFI_DRIVER_ENTRY)>;
    using on_NtNotifyChangeDirectoryFile_fn                        = std::function<NTSTATUS(HANDLE, HANDLE, PIO_APC_ROUTINE, PVOID, PIO_STATUS_BLOCK, PVOID, ULONG, ULONG, BOOLEAN)>;
    using on_NtNotifyChangeKey_fn                                  = std::function<NTSTATUS(HANDLE, HANDLE, PIO_APC_ROUTINE, PVOID, PIO_STATUS_BLOCK, ULONG, BOOLEAN, PVOID, ULONG, BOOLEAN)>;
    using on_NtNotifyChangeMultipleKeys_fn                         = std::function<NTSTATUS(HANDLE, ULONG, POBJECT_ATTRIBUTES, HANDLE, PIO_APC_ROUTINE, PVOID, PIO_STATUS_BLOCK, ULONG, BOOLEAN, PVOID, ULONG, BOOLEAN)>;
    using on_NtNotifyChangeSession_fn                              = std::function<NTSTATUS(HANDLE, ULONG, PVOID, ULONG, IO_SESSION_STATE, IO_SESSION_STATE, PVOID, ULONG)>;
    using on_NtOpenDirectoryObject_fn                              = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenEnlistment_fn                                   = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, HANDLE, LPGUID, POBJECT_ATTRIBUTES)>;
    using on_NtOpenEvent_fn                                        = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenEventPair_fn                                    = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenFile_fn                                         = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PIO_STATUS_BLOCK, ULONG, ULONG)>;
    using on_NtOpenIoCompletion_fn                                 = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenJobObject_fn                                    = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenKeyedEvent_fn                                   = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenKeyEx_fn                                        = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, ULONG)>;
    using on_NtOpenKey_fn                                          = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenKeyTransactedEx_fn                              = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, ULONG, HANDLE)>;
    using on_NtOpenKeyTransacted_fn                                = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, HANDLE)>;
    using on_NtOpenMutant_fn                                       = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenObjectAuditAlarm_fn                             = std::function<NTSTATUS(PUNICODE_STRING, PVOID, PUNICODE_STRING, PUNICODE_STRING, PSECURITY_DESCRIPTOR, HANDLE, ACCESS_MASK, ACCESS_MASK, PPRIVILEGE_SET, BOOLEAN, BOOLEAN, PBOOLEAN)>;
    using on_NtOpenPrivateNamespace_fn                             = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PVOID)>;
    using on_NtOpenProcess_fn                                      = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PCLIENT_ID)>;
    using on_NtOpenProcessTokenEx_fn                               = std::function<NTSTATUS(HANDLE, ACCESS_MASK, ULONG, PHANDLE)>;
    using on_NtOpenProcessToken_fn                                 = std::function<NTSTATUS(HANDLE, ACCESS_MASK, PHANDLE)>;
    using on_NtOpenResourceManager_fn                              = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, HANDLE, LPGUID, POBJECT_ATTRIBUTES)>;
    using on_NtOpenSection_fn                                      = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenSemaphore_fn                                    = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenSession_fn                                      = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenSymbolicLinkObject_fn                           = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenThread_fn                                       = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PCLIENT_ID)>;
    using on_NtOpenThreadTokenEx_fn                                = std::function<NTSTATUS(HANDLE, ACCESS_MASK, BOOLEAN, ULONG, PHANDLE)>;
    using on_NtOpenThreadToken_fn                                  = std::function<NTSTATUS(HANDLE, ACCESS_MASK, BOOLEAN, PHANDLE)>;
    using on_NtOpenTimer_fn                                        = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES)>;
    using on_NtOpenTransactionManager_fn                           = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, PUNICODE_STRING, LPGUID, ULONG)>;
    using on_NtOpenTransaction_fn                                  = std::function<NTSTATUS(PHANDLE, ACCESS_MASK, POBJECT_ATTRIBUTES, LPGUID, HANDLE)>;
    using on_NtPlugPlayControl_fn                                  = std::function<NTSTATUS(PLUGPLAY_CONTROL_CLASS, PVOID, ULONG)>;
    using on_NtPowerInformation_fn                                 = std::function<NTSTATUS(POWER_INFORMATION_LEVEL, PVOID, ULONG, PVOID, ULONG)>;
    using on_NtPrepareComplete_fn                                  = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtPrepareEnlistment_fn                                = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtPrePrepareComplete_fn                               = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtPrePrepareEnlistment_fn                             = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtPrivilegeCheck_fn                                   = std::function<NTSTATUS(HANDLE, PPRIVILEGE_SET, PBOOLEAN)>;
    using on_NtPrivilegedServiceAuditAlarm_fn                      = std::function<NTSTATUS(PUNICODE_STRING, PUNICODE_STRING, HANDLE, PPRIVILEGE_SET, BOOLEAN)>;
    using on_NtPrivilegeObjectAuditAlarm_fn                        = std::function<NTSTATUS(PUNICODE_STRING, PVOID, HANDLE, ACCESS_MASK, PPRIVILEGE_SET, BOOLEAN)>;
    using on_NtPropagationComplete_fn                              = std::function<NTSTATUS(HANDLE, ULONG, ULONG, PVOID)>;
    using on_NtPropagationFailed_fn                                = std::function<NTSTATUS(HANDLE, ULONG, NTSTATUS)>;
    using on_NtProtectVirtualMemory_fn                             = std::function<NTSTATUS(HANDLE, PVOID, PSIZE_T, WIN32_PROTECTION_MASK, PULONG)>;
    using on_NtPulseEvent_fn                                       = std::function<NTSTATUS(HANDLE, PLONG)>;
    using on_NtQueryAttributesFile_fn                              = std::function<NTSTATUS(POBJECT_ATTRIBUTES, PFILE_BASIC_INFORMATION)>;
    using on_NtQueryBootEntryOrder_fn                              = std::function<NTSTATUS(PULONG, PULONG)>;
    using on_NtQueryBootOptions_fn                                 = std::function<NTSTATUS(PBOOT_OPTIONS, PULONG)>;
    using on_NtQueryDebugFilterState_fn                            = std::function<NTSTATUS(ULONG, ULONG)>;
    using on_NtQueryDefaultLocale_fn                               = std::function<NTSTATUS(BOOLEAN, PLCID)>;
    using on_NtQueryDefaultUILanguage_fn                           = std::function<NTSTATUS(LANGID)>;
    using on_NtQueryDirectoryFile_fn                               = std::function<NTSTATUS(HANDLE, HANDLE, PIO_APC_ROUTINE, PVOID, PIO_STATUS_BLOCK, PVOID, ULONG, FILE_INFORMATION_CLASS, BOOLEAN, PUNICODE_STRING, BOOLEAN)>;
    using on_NtQueryDirectoryObject_fn                             = std::function<NTSTATUS(HANDLE, PVOID, ULONG, BOOLEAN, BOOLEAN, PULONG, PULONG)>;
    using on_NtQueryDriverEntryOrder_fn                            = std::function<NTSTATUS(PULONG, PULONG)>;
    using on_NtQueryEaFile_fn                                      = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK, PVOID, ULONG, BOOLEAN, PVOID, ULONG, PULONG, BOOLEAN)>;
    using on_NtQueryEvent_fn                                       = std::function<NTSTATUS(HANDLE, EVENT_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryFullAttributesFile_fn                          = std::function<NTSTATUS(POBJECT_ATTRIBUTES, PFILE_NETWORK_OPEN_INFORMATION)>;
    using on_NtQueryInformationAtom_fn                             = std::function<NTSTATUS(RTL_ATOM, ATOM_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryInformationEnlistment_fn                       = std::function<NTSTATUS(HANDLE, ENLISTMENT_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryInformationFile_fn                             = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK, PVOID, ULONG, FILE_INFORMATION_CLASS)>;
    using on_NtQueryInformationJobObject_fn                        = std::function<NTSTATUS(HANDLE, JOBOBJECTINFOCLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryInformationPort_fn                             = std::function<NTSTATUS(HANDLE, PORT_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryInformationProcess_fn                          = std::function<NTSTATUS(HANDLE, PROCESSINFOCLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryInformationResourceManager_fn                  = std::function<NTSTATUS(HANDLE, RESOURCEMANAGER_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryInformationThread_fn                           = std::function<NTSTATUS(HANDLE, THREADINFOCLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryInformationToken_fn                            = std::function<NTSTATUS(HANDLE, TOKEN_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryInformationTransaction_fn                      = std::function<NTSTATUS(HANDLE, TRANSACTION_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryInformationTransactionManager_fn               = std::function<NTSTATUS(HANDLE, TRANSACTIONMANAGER_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryInformationWorkerFactory_fn                    = std::function<NTSTATUS(HANDLE, WORKERFACTORYINFOCLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryInstallUILanguage_fn                           = std::function<NTSTATUS(LANGID)>;
    using on_NtQueryIntervalProfile_fn                             = std::function<NTSTATUS(KPROFILE_SOURCE, PULONG)>;
    using on_NtQueryIoCompletion_fn                                = std::function<NTSTATUS(HANDLE, IO_COMPLETION_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryKey_fn                                         = std::function<NTSTATUS(HANDLE, KEY_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryLicenseValue_fn                                = std::function<NTSTATUS(PUNICODE_STRING, PULONG, PVOID, ULONG, PULONG)>;
    using on_NtQueryMultipleValueKey_fn                            = std::function<NTSTATUS(HANDLE, PKEY_VALUE_ENTRY, ULONG, PVOID, PULONG, PULONG)>;
    using on_NtQueryMutant_fn                                      = std::function<NTSTATUS(HANDLE, MUTANT_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryObject_fn                                      = std::function<NTSTATUS(HANDLE, OBJECT_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryOpenSubKeysEx_fn                               = std::function<NTSTATUS(POBJECT_ATTRIBUTES, ULONG, PVOID, PULONG)>;
    using on_NtQueryOpenSubKeys_fn                                 = std::function<NTSTATUS(POBJECT_ATTRIBUTES, PULONG)>;
    using on_NtQueryPerformanceCounter_fn                          = std::function<NTSTATUS(PLARGE_INTEGER, PLARGE_INTEGER)>;
    using on_NtQueryQuotaInformationFile_fn                        = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK, PVOID, ULONG, BOOLEAN, PVOID, ULONG, PULONG, BOOLEAN)>;
    using on_NtQuerySection_fn                                     = std::function<NTSTATUS(HANDLE, SECTION_INFORMATION_CLASS, PVOID, SIZE_T, PSIZE_T)>;
    using on_NtQuerySecurityAttributesToken_fn                     = std::function<NTSTATUS(HANDLE, PUNICODE_STRING, ULONG, PVOID, ULONG, PULONG)>;
    using on_NtQuerySecurityObject_fn                              = std::function<NTSTATUS(HANDLE, SECURITY_INFORMATION, PSECURITY_DESCRIPTOR, ULONG, PULONG)>;
    using on_NtQuerySemaphore_fn                                   = std::function<NTSTATUS(HANDLE, SEMAPHORE_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQuerySymbolicLinkObject_fn                          = std::function<NTSTATUS(HANDLE, PUNICODE_STRING, PULONG)>;
    using on_NtQuerySystemEnvironmentValueEx_fn                    = std::function<NTSTATUS(PUNICODE_STRING, LPGUID, PVOID, PULONG, PULONG)>;
    using on_NtQuerySystemEnvironmentValue_fn                      = std::function<NTSTATUS(PUNICODE_STRING, PWSTR, USHORT, PUSHORT)>;
    using on_NtQuerySystemInformationEx_fn                         = std::function<NTSTATUS(SYSTEM_INFORMATION_CLASS, PVOID, ULONG, PVOID, ULONG, PULONG)>;
    using on_NtQuerySystemInformation_fn                           = std::function<NTSTATUS(SYSTEM_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQuerySystemTime_fn                                  = std::function<NTSTATUS(PLARGE_INTEGER)>;
    using on_NtQueryTimer_fn                                       = std::function<NTSTATUS(HANDLE, TIMER_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryTimerResolution_fn                             = std::function<NTSTATUS(PULONG, PULONG, PULONG)>;
    using on_NtQueryValueKey_fn                                    = std::function<NTSTATUS(HANDLE, PUNICODE_STRING, KEY_VALUE_INFORMATION_CLASS, PVOID, ULONG, PULONG)>;
    using on_NtQueryVirtualMemory_fn                               = std::function<NTSTATUS(HANDLE, PVOID, MEMORY_INFORMATION_CLASS, PVOID, SIZE_T, PSIZE_T)>;
    using on_NtQueryVolumeInformationFile_fn                       = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK, PVOID, ULONG, FS_INFORMATION_CLASS)>;
    using on_NtQueueApcThreadEx_fn                                 = std::function<NTSTATUS(HANDLE, HANDLE, PPS_APC_ROUTINE, PVOID, PVOID, PVOID)>;
    using on_NtQueueApcThread_fn                                   = std::function<NTSTATUS(HANDLE, PPS_APC_ROUTINE, PVOID, PVOID, PVOID)>;
    using on_NtRaiseException_fn                                   = std::function<NTSTATUS(PEXCEPTION_RECORD, PCONTEXT, BOOLEAN)>;
    using on_NtRaiseHardError_fn                                   = std::function<NTSTATUS(NTSTATUS, ULONG, ULONG, PULONG_PTR, ULONG, PULONG)>;
    using on_NtReadFile_fn                                         = std::function<NTSTATUS(HANDLE, HANDLE, PIO_APC_ROUTINE, PVOID, PIO_STATUS_BLOCK, PVOID, ULONG, PLARGE_INTEGER, PULONG)>;
    using on_NtReadFileScatter_fn                                  = std::function<NTSTATUS(HANDLE, HANDLE, PIO_APC_ROUTINE, PVOID, PIO_STATUS_BLOCK, PFILE_SEGMENT_ELEMENT, ULONG, PLARGE_INTEGER, PULONG)>;
    using on_NtReadOnlyEnlistment_fn                               = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtReadRequestData_fn                                  = std::function<NTSTATUS(HANDLE, PPORT_MESSAGE, ULONG, PVOID, SIZE_T, PSIZE_T)>;
    using on_NtReadVirtualMemory_fn                                = std::function<NTSTATUS(HANDLE, PVOID, PVOID, SIZE_T, PSIZE_T)>;
    using on_NtRecoverEnlistment_fn                                = std::function<NTSTATUS(HANDLE, PVOID)>;
    using on_NtRecoverResourceManager_fn                           = std::function<NTSTATUS(HANDLE)>;
    using on_NtRecoverTransactionManager_fn                        = std::function<NTSTATUS(HANDLE)>;
    using on_NtRegisterProtocolAddressInformation_fn               = std::function<NTSTATUS(HANDLE, PCRM_PROTOCOL_ID, ULONG, PVOID, ULONG)>;
    using on_NtRegisterThreadTerminatePort_fn                      = std::function<NTSTATUS(HANDLE)>;
    using on_NtReleaseKeyedEvent_fn                                = std::function<NTSTATUS(HANDLE, PVOID, BOOLEAN, PLARGE_INTEGER)>;
    using on_NtReleaseMutant_fn                                    = std::function<NTSTATUS(HANDLE, PLONG)>;
    using on_NtReleaseSemaphore_fn                                 = std::function<NTSTATUS(HANDLE, LONG, PLONG)>;
    using on_NtReleaseWorkerFactoryWorker_fn                       = std::function<NTSTATUS(HANDLE)>;
    using on_NtRemoveIoCompletionEx_fn                             = std::function<NTSTATUS(HANDLE, PFILE_IO_COMPLETION_INFORMATION, ULONG, PULONG, PLARGE_INTEGER, BOOLEAN)>;
    using on_NtRemoveIoCompletion_fn                               = std::function<NTSTATUS(HANDLE, PVOID, PVOID, PIO_STATUS_BLOCK, PLARGE_INTEGER)>;
    using on_NtRemoveProcessDebug_fn                               = std::function<NTSTATUS(HANDLE, HANDLE)>;
    using on_NtRenameKey_fn                                        = std::function<NTSTATUS(HANDLE, PUNICODE_STRING)>;
    using on_NtRenameTransactionManager_fn                         = std::function<NTSTATUS(PUNICODE_STRING, LPGUID)>;
    using on_NtReplaceKey_fn                                       = std::function<NTSTATUS(POBJECT_ATTRIBUTES, HANDLE, POBJECT_ATTRIBUTES)>;
    using on_NtReplacePartitionUnit_fn                             = std::function<NTSTATUS(PUNICODE_STRING, PUNICODE_STRING, ULONG)>;
    using on_NtReplyPort_fn                                        = std::function<NTSTATUS(HANDLE, PPORT_MESSAGE)>;
    using on_NtReplyWaitReceivePortEx_fn                           = std::function<NTSTATUS(HANDLE, PVOID, PPORT_MESSAGE, PPORT_MESSAGE, PLARGE_INTEGER)>;
    using on_NtReplyWaitReceivePort_fn                             = std::function<NTSTATUS(HANDLE, PVOID, PPORT_MESSAGE, PPORT_MESSAGE)>;
    using on_NtReplyWaitReplyPort_fn                               = std::function<NTSTATUS(HANDLE, PPORT_MESSAGE)>;
    using on_NtRequestPort_fn                                      = std::function<NTSTATUS(HANDLE, PPORT_MESSAGE)>;
    using on_NtRequestWaitReplyPort_fn                             = std::function<NTSTATUS(HANDLE, PPORT_MESSAGE, PPORT_MESSAGE)>;
    using on_NtResetEvent_fn                                       = std::function<NTSTATUS(HANDLE, PLONG)>;
    using on_NtResetWriteWatch_fn                                  = std::function<NTSTATUS(HANDLE, PVOID, SIZE_T)>;
    using on_NtRestoreKey_fn                                       = std::function<NTSTATUS(HANDLE, HANDLE, ULONG)>;
    using on_NtResumeProcess_fn                                    = std::function<NTSTATUS(HANDLE)>;
    using on_NtResumeThread_fn                                     = std::function<NTSTATUS(HANDLE, PULONG)>;
    using on_NtRollbackComplete_fn                                 = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtRollbackEnlistment_fn                               = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtRollbackTransaction_fn                              = std::function<NTSTATUS(HANDLE, BOOLEAN)>;
    using on_NtRollforwardTransactionManager_fn                    = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtSaveKeyEx_fn                                        = std::function<NTSTATUS(HANDLE, HANDLE, ULONG)>;
    using on_NtSaveKey_fn                                          = std::function<NTSTATUS(HANDLE, HANDLE)>;
    using on_NtSaveMergedKeys_fn                                   = std::function<NTSTATUS(HANDLE, HANDLE, HANDLE)>;
    using on_NtSecureConnectPort_fn                                = std::function<NTSTATUS(PHANDLE, PUNICODE_STRING, PSECURITY_QUALITY_OF_SERVICE, PPORT_VIEW, PSID, PREMOTE_PORT_VIEW, PULONG, PVOID, PULONG)>;
    using on_NtSetBootEntryOrder_fn                                = std::function<NTSTATUS(PULONG, ULONG)>;
    using on_NtSetBootOptions_fn                                   = std::function<NTSTATUS(PBOOT_OPTIONS, ULONG)>;
    using on_NtSetContextThread_fn                                 = std::function<NTSTATUS(HANDLE, PCONTEXT)>;
    using on_NtSetDebugFilterState_fn                              = std::function<NTSTATUS(ULONG, ULONG, BOOLEAN)>;
    using on_NtSetDefaultHardErrorPort_fn                          = std::function<NTSTATUS(HANDLE)>;
    using on_NtSetDefaultLocale_fn                                 = std::function<NTSTATUS(BOOLEAN, LCID)>;
    using on_NtSetDefaultUILanguage_fn                             = std::function<NTSTATUS(LANGID)>;
    using on_NtSetDriverEntryOrder_fn                              = std::function<NTSTATUS(PULONG, ULONG)>;
    using on_NtSetEaFile_fn                                        = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK, PVOID, ULONG)>;
    using on_NtSetEventBoostPriority_fn                            = std::function<NTSTATUS(HANDLE)>;
    using on_NtSetEvent_fn                                         = std::function<NTSTATUS(HANDLE, PLONG)>;
    using on_NtSetHighEventPair_fn                                 = std::function<NTSTATUS(HANDLE)>;
    using on_NtSetHighWaitLowEventPair_fn                          = std::function<NTSTATUS(HANDLE)>;
    using on_NtSetInformationDebugObject_fn                        = std::function<NTSTATUS(HANDLE, DEBUGOBJECTINFOCLASS, PVOID, ULONG, PULONG)>;
    using on_NtSetInformationEnlistment_fn                         = std::function<NTSTATUS(HANDLE, ENLISTMENT_INFORMATION_CLASS, PVOID, ULONG)>;
    using on_NtSetInformationFile_fn                               = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK, PVOID, ULONG, FILE_INFORMATION_CLASS)>;
    using on_NtSetInformationJobObject_fn                          = std::function<NTSTATUS(HANDLE, JOBOBJECTINFOCLASS, PVOID, ULONG)>;
    using on_NtSetInformationKey_fn                                = std::function<NTSTATUS(HANDLE, KEY_SET_INFORMATION_CLASS, PVOID, ULONG)>;
    using on_NtSetInformationObject_fn                             = std::function<NTSTATUS(HANDLE, OBJECT_INFORMATION_CLASS, PVOID, ULONG)>;
    using on_NtSetInformationProcess_fn                            = std::function<NTSTATUS(HANDLE, PROCESSINFOCLASS, PVOID, ULONG)>;
    using on_NtSetInformationResourceManager_fn                    = std::function<NTSTATUS(HANDLE, RESOURCEMANAGER_INFORMATION_CLASS, PVOID, ULONG)>;
    using on_NtSetInformationThread_fn                             = std::function<NTSTATUS(HANDLE, THREADINFOCLASS, PVOID, ULONG)>;
    using on_NtSetInformationToken_fn                              = std::function<NTSTATUS(HANDLE, TOKEN_INFORMATION_CLASS, PVOID, ULONG)>;
    using on_NtSetInformationTransaction_fn                        = std::function<NTSTATUS(HANDLE, TRANSACTION_INFORMATION_CLASS, PVOID, ULONG)>;
    using on_NtSetInformationTransactionManager_fn                 = std::function<NTSTATUS(HANDLE, TRANSACTIONMANAGER_INFORMATION_CLASS, PVOID, ULONG)>;
    using on_NtSetInformationWorkerFactory_fn                      = std::function<NTSTATUS(HANDLE, WORKERFACTORYINFOCLASS, PVOID, ULONG)>;
    using on_NtSetIntervalProfile_fn                               = std::function<NTSTATUS(ULONG, KPROFILE_SOURCE)>;
    using on_NtSetIoCompletionEx_fn                                = std::function<NTSTATUS(HANDLE, HANDLE, PVOID, PVOID, NTSTATUS, ULONG_PTR)>;
    using on_NtSetIoCompletion_fn                                  = std::function<NTSTATUS(HANDLE, PVOID, PVOID, NTSTATUS, ULONG_PTR)>;
    using on_NtSetLdtEntries_fn                                    = std::function<NTSTATUS(ULONG, ULONG, ULONG, ULONG, ULONG, ULONG)>;
    using on_NtSetLowEventPair_fn                                  = std::function<NTSTATUS(HANDLE)>;
    using on_NtSetLowWaitHighEventPair_fn                          = std::function<NTSTATUS(HANDLE)>;
    using on_NtSetQuotaInformationFile_fn                          = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK, PVOID, ULONG)>;
    using on_NtSetSecurityObject_fn                                = std::function<NTSTATUS(HANDLE, SECURITY_INFORMATION, PSECURITY_DESCRIPTOR)>;
    using on_NtSetSystemEnvironmentValueEx_fn                      = std::function<NTSTATUS(PUNICODE_STRING, LPGUID, PVOID, ULONG, ULONG)>;
    using on_NtSetSystemEnvironmentValue_fn                        = std::function<NTSTATUS(PUNICODE_STRING, PUNICODE_STRING)>;
    using on_NtSetSystemInformation_fn                             = std::function<NTSTATUS(SYSTEM_INFORMATION_CLASS, PVOID, ULONG)>;
    using on_NtSetSystemPowerState_fn                              = std::function<NTSTATUS(POWER_ACTION, SYSTEM_POWER_STATE, ULONG)>;
    using on_NtSetSystemTime_fn                                    = std::function<NTSTATUS(PLARGE_INTEGER, PLARGE_INTEGER)>;
    using on_NtSetThreadExecutionState_fn                          = std::function<NTSTATUS(EXECUTION_STATE, EXECUTION_STATE)>;
    using on_NtSetTimerEx_fn                                       = std::function<NTSTATUS(HANDLE, TIMER_SET_INFORMATION_CLASS, PVOID, ULONG)>;
    using on_NtSetTimer_fn                                         = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER, PTIMER_APC_ROUTINE, PVOID, BOOLEAN, LONG, PBOOLEAN)>;
    using on_NtSetTimerResolution_fn                               = std::function<NTSTATUS(ULONG, BOOLEAN, PULONG)>;
    using on_NtSetUuidSeed_fn                                      = std::function<NTSTATUS(PCHAR)>;
    using on_NtSetValueKey_fn                                      = std::function<NTSTATUS(HANDLE, PUNICODE_STRING, ULONG, ULONG, PVOID, ULONG)>;
    using on_NtSetVolumeInformationFile_fn                         = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK, PVOID, ULONG, FS_INFORMATION_CLASS)>;
    using on_NtShutdownSystem_fn                                   = std::function<NTSTATUS(SHUTDOWN_ACTION)>;
    using on_NtShutdownWorkerFactory_fn                            = std::function<NTSTATUS(HANDLE, LONG)>;
    using on_NtSignalAndWaitForSingleObject_fn                     = std::function<NTSTATUS(HANDLE, HANDLE, BOOLEAN, PLARGE_INTEGER)>;
    using on_NtSinglePhaseReject_fn                                = std::function<NTSTATUS(HANDLE, PLARGE_INTEGER)>;
    using on_NtStartProfile_fn                                     = std::function<NTSTATUS(HANDLE)>;
    using on_NtStopProfile_fn                                      = std::function<NTSTATUS(HANDLE)>;
    using on_NtSuspendProcess_fn                                   = std::function<NTSTATUS(HANDLE)>;
    using on_NtSuspendThread_fn                                    = std::function<NTSTATUS(HANDLE, PULONG)>;
    using on_NtSystemDebugControl_fn                               = std::function<NTSTATUS(SYSDBG_COMMAND, PVOID, ULONG, PVOID, ULONG, PULONG)>;
    using on_NtTerminateJobObject_fn                               = std::function<NTSTATUS(HANDLE, NTSTATUS)>;
    using on_NtTerminateProcess_fn                                 = std::function<NTSTATUS(HANDLE, NTSTATUS)>;
    using on_NtTerminateThread_fn                                  = std::function<NTSTATUS(HANDLE, NTSTATUS)>;
    using on_NtTraceControl_fn                                     = std::function<NTSTATUS(ULONG, PVOID, ULONG, PVOID, ULONG, PULONG)>;
    using on_NtTraceEvent_fn                                       = std::function<NTSTATUS(HANDLE, ULONG, ULONG, PVOID)>;
    using on_NtTranslateFilePath_fn                                = std::function<NTSTATUS(PFILE_PATH, ULONG, PFILE_PATH, PULONG)>;
    using on_NtUnloadDriver_fn                                     = std::function<NTSTATUS(PUNICODE_STRING)>;
    using on_NtUnloadKey2_fn                                       = std::function<NTSTATUS(POBJECT_ATTRIBUTES, ULONG)>;
    using on_NtUnloadKeyEx_fn                                      = std::function<NTSTATUS(POBJECT_ATTRIBUTES, HANDLE)>;
    using on_NtUnloadKey_fn                                        = std::function<NTSTATUS(POBJECT_ATTRIBUTES)>;
    using on_NtUnlockFile_fn                                       = std::function<NTSTATUS(HANDLE, PIO_STATUS_BLOCK, PLARGE_INTEGER, PLARGE_INTEGER, ULONG)>;
    using on_NtUnlockVirtualMemory_fn                              = std::function<NTSTATUS(HANDLE, PVOID, PSIZE_T, ULONG)>;
    using on_NtUnmapViewOfSection_fn                               = std::function<NTSTATUS(HANDLE, PVOID)>;
    using on_NtVdmControl_fn                                       = std::function<NTSTATUS(VDMSERVICECLASS, PVOID)>;
    using on_NtWaitForDebugEvent_fn                                = std::function<NTSTATUS(HANDLE, BOOLEAN, PLARGE_INTEGER, PDBGUI_WAIT_STATE_CHANGE)>;
    using on_NtWaitForKeyedEvent_fn                                = std::function<NTSTATUS(HANDLE, PVOID, BOOLEAN, PLARGE_INTEGER)>;
    using on_NtWaitForMultipleObjects32_fn                         = std::function<NTSTATUS(ULONG, LONG, WAIT_TYPE, BOOLEAN, PLARGE_INTEGER)>;
    using on_NtWaitForMultipleObjects_fn                           = std::function<NTSTATUS(ULONG, HANDLE, WAIT_TYPE, BOOLEAN, PLARGE_INTEGER)>;
    using on_NtWaitForSingleObject_fn                              = std::function<NTSTATUS(HANDLE, BOOLEAN, PLARGE_INTEGER)>;
    using on_NtWaitForWorkViaWorkerFactory_fn                      = std::function<NTSTATUS(HANDLE, PFILE_IO_COMPLETION_INFORMATION)>;
    using on_NtWaitHighEventPair_fn                                = std::function<NTSTATUS(HANDLE)>;
    using on_NtWaitLowEventPair_fn                                 = std::function<NTSTATUS(HANDLE)>;
    using on_NtWorkerFactoryWorkerReady_fn                         = std::function<NTSTATUS(HANDLE)>;
    using on_NtWriteFileGather_fn                                  = std::function<NTSTATUS(HANDLE, HANDLE, PIO_APC_ROUTINE, PVOID, PIO_STATUS_BLOCK, PFILE_SEGMENT_ELEMENT, ULONG, PLARGE_INTEGER, PULONG)>;
    using on_NtWriteFile_fn                                        = std::function<NTSTATUS(HANDLE, HANDLE, PIO_APC_ROUTINE, PVOID, PIO_STATUS_BLOCK, PVOID, ULONG, PLARGE_INTEGER, PULONG)>;
    using on_NtWriteRequestData_fn                                 = std::function<NTSTATUS(HANDLE, PPORT_MESSAGE, ULONG, PVOID, SIZE_T, PSIZE_T)>;
    using on_NtWriteVirtualMemory_fn                               = std::function<NTSTATUS(HANDLE, PVOID, PVOID, SIZE_T, PSIZE_T)>;
    using on_NtDisableLastKnownGood_fn                             = std::function<NTSTATUS()>;
    using on_NtEnableLastKnownGood_fn                              = std::function<NTSTATUS()>;
    using on_NtFlushProcessWriteBuffers_fn                         = std::function<VOID()>;
    using on_NtFlushWriteBuffer_fn                                 = std::function<NTSTATUS()>;
    using on_NtGetCurrentProcessorNumber_fn                        = std::function<ULONG()>;
    using on_NtIsSystemResumeAutomatic_fn                          = std::function<BOOLEAN()>;
    using on_NtIsUILanguageComitted_fn                             = std::function<NTSTATUS()>;
    using on_NtQueryPortInformationProcess_fn                      = std::function<NTSTATUS()>;
    using on_NtSerializeBoot_fn                                    = std::function<NTSTATUS()>;
    using on_NtTestAlert_fn                                        = std::function<NTSTATUS()>;
    using on_NtThawRegistry_fn                                     = std::function<NTSTATUS()>;
    using on_NtThawTransactions_fn                                 = std::function<NTSTATUS()>;
    using on_NtUmsThreadYield_fn                                   = std::function<NTSTATUS()>;
    using on_NtYieldExecution_fn                                   = std::function<NTSTATUS()>;

    struct syscalls
    {
         syscalls(core::Core& core, std::string_view module);
        ~syscalls();

        using on_call_fn = std::function<void(const tracer::callcfg_t& callcfg)>;
        using id_t       = uint64_t;

        opt<id_t>   register_all(proc_t proc, const on_call_fn& on_call);
        bool        unregister  (id_t id);

        opt<id_t> register_NtAcceptConnectPort                               (proc_t proc, const on_NtAcceptConnectPort_fn& on_func);
        opt<id_t> register_NtAccessCheckAndAuditAlarm                        (proc_t proc, const on_NtAccessCheckAndAuditAlarm_fn& on_func);
        opt<id_t> register_NtAccessCheckByTypeAndAuditAlarm                  (proc_t proc, const on_NtAccessCheckByTypeAndAuditAlarm_fn& on_func);
        opt<id_t> register_NtAccessCheckByType                               (proc_t proc, const on_NtAccessCheckByType_fn& on_func);
        opt<id_t> register_NtAccessCheckByTypeResultListAndAuditAlarmByHandle(proc_t proc, const on_NtAccessCheckByTypeResultListAndAuditAlarmByHandle_fn& on_func);
        opt<id_t> register_NtAccessCheckByTypeResultListAndAuditAlarm        (proc_t proc, const on_NtAccessCheckByTypeResultListAndAuditAlarm_fn& on_func);
        opt<id_t> register_NtAccessCheckByTypeResultList                     (proc_t proc, const on_NtAccessCheckByTypeResultList_fn& on_func);
        opt<id_t> register_NtAccessCheck                                     (proc_t proc, const on_NtAccessCheck_fn& on_func);
        opt<id_t> register_NtAddAtom                                         (proc_t proc, const on_NtAddAtom_fn& on_func);
        opt<id_t> register_NtAddBootEntry                                    (proc_t proc, const on_NtAddBootEntry_fn& on_func);
        opt<id_t> register_NtAddDriverEntry                                  (proc_t proc, const on_NtAddDriverEntry_fn& on_func);
        opt<id_t> register_NtAdjustGroupsToken                               (proc_t proc, const on_NtAdjustGroupsToken_fn& on_func);
        opt<id_t> register_NtAdjustPrivilegesToken                           (proc_t proc, const on_NtAdjustPrivilegesToken_fn& on_func);
        opt<id_t> register_NtAlertResumeThread                               (proc_t proc, const on_NtAlertResumeThread_fn& on_func);
        opt<id_t> register_NtAlertThread                                     (proc_t proc, const on_NtAlertThread_fn& on_func);
        opt<id_t> register_NtAllocateLocallyUniqueId                         (proc_t proc, const on_NtAllocateLocallyUniqueId_fn& on_func);
        opt<id_t> register_NtAllocateReserveObject                           (proc_t proc, const on_NtAllocateReserveObject_fn& on_func);
        opt<id_t> register_NtAllocateUserPhysicalPages                       (proc_t proc, const on_NtAllocateUserPhysicalPages_fn& on_func);
        opt<id_t> register_NtAllocateUuids                                   (proc_t proc, const on_NtAllocateUuids_fn& on_func);
        opt<id_t> register_NtAllocateVirtualMemory                           (proc_t proc, const on_NtAllocateVirtualMemory_fn& on_func);
        opt<id_t> register_NtAlpcAcceptConnectPort                           (proc_t proc, const on_NtAlpcAcceptConnectPort_fn& on_func);
        opt<id_t> register_NtAlpcCancelMessage                               (proc_t proc, const on_NtAlpcCancelMessage_fn& on_func);
        opt<id_t> register_NtAlpcConnectPort                                 (proc_t proc, const on_NtAlpcConnectPort_fn& on_func);
        opt<id_t> register_NtAlpcCreatePort                                  (proc_t proc, const on_NtAlpcCreatePort_fn& on_func);
        opt<id_t> register_NtAlpcCreatePortSection                           (proc_t proc, const on_NtAlpcCreatePortSection_fn& on_func);
        opt<id_t> register_NtAlpcCreateResourceReserve                       (proc_t proc, const on_NtAlpcCreateResourceReserve_fn& on_func);
        opt<id_t> register_NtAlpcCreateSectionView                           (proc_t proc, const on_NtAlpcCreateSectionView_fn& on_func);
        opt<id_t> register_NtAlpcCreateSecurityContext                       (proc_t proc, const on_NtAlpcCreateSecurityContext_fn& on_func);
        opt<id_t> register_NtAlpcDeletePortSection                           (proc_t proc, const on_NtAlpcDeletePortSection_fn& on_func);
        opt<id_t> register_NtAlpcDeleteResourceReserve                       (proc_t proc, const on_NtAlpcDeleteResourceReserve_fn& on_func);
        opt<id_t> register_NtAlpcDeleteSectionView                           (proc_t proc, const on_NtAlpcDeleteSectionView_fn& on_func);
        opt<id_t> register_NtAlpcDeleteSecurityContext                       (proc_t proc, const on_NtAlpcDeleteSecurityContext_fn& on_func);
        opt<id_t> register_NtAlpcDisconnectPort                              (proc_t proc, const on_NtAlpcDisconnectPort_fn& on_func);
        opt<id_t> register_NtAlpcImpersonateClientOfPort                     (proc_t proc, const on_NtAlpcImpersonateClientOfPort_fn& on_func);
        opt<id_t> register_NtAlpcOpenSenderProcess                           (proc_t proc, const on_NtAlpcOpenSenderProcess_fn& on_func);
        opt<id_t> register_NtAlpcOpenSenderThread                            (proc_t proc, const on_NtAlpcOpenSenderThread_fn& on_func);
        opt<id_t> register_NtAlpcQueryInformation                            (proc_t proc, const on_NtAlpcQueryInformation_fn& on_func);
        opt<id_t> register_NtAlpcQueryInformationMessage                     (proc_t proc, const on_NtAlpcQueryInformationMessage_fn& on_func);
        opt<id_t> register_NtAlpcRevokeSecurityContext                       (proc_t proc, const on_NtAlpcRevokeSecurityContext_fn& on_func);
        opt<id_t> register_NtAlpcSendWaitReceivePort                         (proc_t proc, const on_NtAlpcSendWaitReceivePort_fn& on_func);
        opt<id_t> register_NtAlpcSetInformation                              (proc_t proc, const on_NtAlpcSetInformation_fn& on_func);
        opt<id_t> register_NtApphelpCacheControl                             (proc_t proc, const on_NtApphelpCacheControl_fn& on_func);
        opt<id_t> register_NtAreMappedFilesTheSame                           (proc_t proc, const on_NtAreMappedFilesTheSame_fn& on_func);
        opt<id_t> register_NtAssignProcessToJobObject                        (proc_t proc, const on_NtAssignProcessToJobObject_fn& on_func);
        opt<id_t> register_NtCancelIoFileEx                                  (proc_t proc, const on_NtCancelIoFileEx_fn& on_func);
        opt<id_t> register_NtCancelIoFile                                    (proc_t proc, const on_NtCancelIoFile_fn& on_func);
        opt<id_t> register_NtCancelSynchronousIoFile                         (proc_t proc, const on_NtCancelSynchronousIoFile_fn& on_func);
        opt<id_t> register_NtCancelTimer                                     (proc_t proc, const on_NtCancelTimer_fn& on_func);
        opt<id_t> register_NtClearEvent                                      (proc_t proc, const on_NtClearEvent_fn& on_func);
        opt<id_t> register_NtClose                                           (proc_t proc, const on_NtClose_fn& on_func);
        opt<id_t> register_NtCloseObjectAuditAlarm                           (proc_t proc, const on_NtCloseObjectAuditAlarm_fn& on_func);
        opt<id_t> register_NtCommitComplete                                  (proc_t proc, const on_NtCommitComplete_fn& on_func);
        opt<id_t> register_NtCommitEnlistment                                (proc_t proc, const on_NtCommitEnlistment_fn& on_func);
        opt<id_t> register_NtCommitTransaction                               (proc_t proc, const on_NtCommitTransaction_fn& on_func);
        opt<id_t> register_NtCompactKeys                                     (proc_t proc, const on_NtCompactKeys_fn& on_func);
        opt<id_t> register_NtCompareTokens                                   (proc_t proc, const on_NtCompareTokens_fn& on_func);
        opt<id_t> register_NtCompleteConnectPort                             (proc_t proc, const on_NtCompleteConnectPort_fn& on_func);
        opt<id_t> register_NtCompressKey                                     (proc_t proc, const on_NtCompressKey_fn& on_func);
        opt<id_t> register_NtConnectPort                                     (proc_t proc, const on_NtConnectPort_fn& on_func);
        opt<id_t> register_NtContinue                                        (proc_t proc, const on_NtContinue_fn& on_func);
        opt<id_t> register_NtCreateDebugObject                               (proc_t proc, const on_NtCreateDebugObject_fn& on_func);
        opt<id_t> register_NtCreateDirectoryObject                           (proc_t proc, const on_NtCreateDirectoryObject_fn& on_func);
        opt<id_t> register_NtCreateEnlistment                                (proc_t proc, const on_NtCreateEnlistment_fn& on_func);
        opt<id_t> register_NtCreateEvent                                     (proc_t proc, const on_NtCreateEvent_fn& on_func);
        opt<id_t> register_NtCreateEventPair                                 (proc_t proc, const on_NtCreateEventPair_fn& on_func);
        opt<id_t> register_NtCreateFile                                      (proc_t proc, const on_NtCreateFile_fn& on_func);
        opt<id_t> register_NtCreateIoCompletion                              (proc_t proc, const on_NtCreateIoCompletion_fn& on_func);
        opt<id_t> register_NtCreateJobObject                                 (proc_t proc, const on_NtCreateJobObject_fn& on_func);
        opt<id_t> register_NtCreateJobSet                                    (proc_t proc, const on_NtCreateJobSet_fn& on_func);
        opt<id_t> register_NtCreateKeyedEvent                                (proc_t proc, const on_NtCreateKeyedEvent_fn& on_func);
        opt<id_t> register_NtCreateKey                                       (proc_t proc, const on_NtCreateKey_fn& on_func);
        opt<id_t> register_NtCreateKeyTransacted                             (proc_t proc, const on_NtCreateKeyTransacted_fn& on_func);
        opt<id_t> register_NtCreateMailslotFile                              (proc_t proc, const on_NtCreateMailslotFile_fn& on_func);
        opt<id_t> register_NtCreateMutant                                    (proc_t proc, const on_NtCreateMutant_fn& on_func);
        opt<id_t> register_NtCreateNamedPipeFile                             (proc_t proc, const on_NtCreateNamedPipeFile_fn& on_func);
        opt<id_t> register_NtCreatePagingFile                                (proc_t proc, const on_NtCreatePagingFile_fn& on_func);
        opt<id_t> register_NtCreatePort                                      (proc_t proc, const on_NtCreatePort_fn& on_func);
        opt<id_t> register_NtCreatePrivateNamespace                          (proc_t proc, const on_NtCreatePrivateNamespace_fn& on_func);
        opt<id_t> register_NtCreateProcessEx                                 (proc_t proc, const on_NtCreateProcessEx_fn& on_func);
        opt<id_t> register_NtCreateProcess                                   (proc_t proc, const on_NtCreateProcess_fn& on_func);
        opt<id_t> register_NtCreateProfileEx                                 (proc_t proc, const on_NtCreateProfileEx_fn& on_func);
        opt<id_t> register_NtCreateProfile                                   (proc_t proc, const on_NtCreateProfile_fn& on_func);
        opt<id_t> register_NtCreateResourceManager                           (proc_t proc, const on_NtCreateResourceManager_fn& on_func);
        opt<id_t> register_NtCreateSection                                   (proc_t proc, const on_NtCreateSection_fn& on_func);
        opt<id_t> register_NtCreateSemaphore                                 (proc_t proc, const on_NtCreateSemaphore_fn& on_func);
        opt<id_t> register_NtCreateSymbolicLinkObject                        (proc_t proc, const on_NtCreateSymbolicLinkObject_fn& on_func);
        opt<id_t> register_NtCreateThreadEx                                  (proc_t proc, const on_NtCreateThreadEx_fn& on_func);
        opt<id_t> register_NtCreateThread                                    (proc_t proc, const on_NtCreateThread_fn& on_func);
        opt<id_t> register_NtCreateTimer                                     (proc_t proc, const on_NtCreateTimer_fn& on_func);
        opt<id_t> register_NtCreateToken                                     (proc_t proc, const on_NtCreateToken_fn& on_func);
        opt<id_t> register_NtCreateTransactionManager                        (proc_t proc, const on_NtCreateTransactionManager_fn& on_func);
        opt<id_t> register_NtCreateTransaction                               (proc_t proc, const on_NtCreateTransaction_fn& on_func);
        opt<id_t> register_NtCreateUserProcess                               (proc_t proc, const on_NtCreateUserProcess_fn& on_func);
        opt<id_t> register_NtCreateWaitablePort                              (proc_t proc, const on_NtCreateWaitablePort_fn& on_func);
        opt<id_t> register_NtCreateWorkerFactory                             (proc_t proc, const on_NtCreateWorkerFactory_fn& on_func);
        opt<id_t> register_NtDebugActiveProcess                              (proc_t proc, const on_NtDebugActiveProcess_fn& on_func);
        opt<id_t> register_NtDebugContinue                                   (proc_t proc, const on_NtDebugContinue_fn& on_func);
        opt<id_t> register_NtDelayExecution                                  (proc_t proc, const on_NtDelayExecution_fn& on_func);
        opt<id_t> register_NtDeleteAtom                                      (proc_t proc, const on_NtDeleteAtom_fn& on_func);
        opt<id_t> register_NtDeleteBootEntry                                 (proc_t proc, const on_NtDeleteBootEntry_fn& on_func);
        opt<id_t> register_NtDeleteDriverEntry                               (proc_t proc, const on_NtDeleteDriverEntry_fn& on_func);
        opt<id_t> register_NtDeleteFile                                      (proc_t proc, const on_NtDeleteFile_fn& on_func);
        opt<id_t> register_NtDeleteKey                                       (proc_t proc, const on_NtDeleteKey_fn& on_func);
        opt<id_t> register_NtDeleteObjectAuditAlarm                          (proc_t proc, const on_NtDeleteObjectAuditAlarm_fn& on_func);
        opt<id_t> register_NtDeletePrivateNamespace                          (proc_t proc, const on_NtDeletePrivateNamespace_fn& on_func);
        opt<id_t> register_NtDeleteValueKey                                  (proc_t proc, const on_NtDeleteValueKey_fn& on_func);
        opt<id_t> register_NtDeviceIoControlFile                             (proc_t proc, const on_NtDeviceIoControlFile_fn& on_func);
        opt<id_t> register_NtDisplayString                                   (proc_t proc, const on_NtDisplayString_fn& on_func);
        opt<id_t> register_NtDrawText                                        (proc_t proc, const on_NtDrawText_fn& on_func);
        opt<id_t> register_NtDuplicateObject                                 (proc_t proc, const on_NtDuplicateObject_fn& on_func);
        opt<id_t> register_NtDuplicateToken                                  (proc_t proc, const on_NtDuplicateToken_fn& on_func);
        opt<id_t> register_NtEnumerateBootEntries                            (proc_t proc, const on_NtEnumerateBootEntries_fn& on_func);
        opt<id_t> register_NtEnumerateDriverEntries                          (proc_t proc, const on_NtEnumerateDriverEntries_fn& on_func);
        opt<id_t> register_NtEnumerateKey                                    (proc_t proc, const on_NtEnumerateKey_fn& on_func);
        opt<id_t> register_NtEnumerateSystemEnvironmentValuesEx              (proc_t proc, const on_NtEnumerateSystemEnvironmentValuesEx_fn& on_func);
        opt<id_t> register_NtEnumerateTransactionObject                      (proc_t proc, const on_NtEnumerateTransactionObject_fn& on_func);
        opt<id_t> register_NtEnumerateValueKey                               (proc_t proc, const on_NtEnumerateValueKey_fn& on_func);
        opt<id_t> register_NtExtendSection                                   (proc_t proc, const on_NtExtendSection_fn& on_func);
        opt<id_t> register_NtFilterToken                                     (proc_t proc, const on_NtFilterToken_fn& on_func);
        opt<id_t> register_NtFindAtom                                        (proc_t proc, const on_NtFindAtom_fn& on_func);
        opt<id_t> register_NtFlushBuffersFile                                (proc_t proc, const on_NtFlushBuffersFile_fn& on_func);
        opt<id_t> register_NtFlushInstallUILanguage                          (proc_t proc, const on_NtFlushInstallUILanguage_fn& on_func);
        opt<id_t> register_NtFlushInstructionCache                           (proc_t proc, const on_NtFlushInstructionCache_fn& on_func);
        opt<id_t> register_NtFlushKey                                        (proc_t proc, const on_NtFlushKey_fn& on_func);
        opt<id_t> register_NtFlushVirtualMemory                              (proc_t proc, const on_NtFlushVirtualMemory_fn& on_func);
        opt<id_t> register_NtFreeUserPhysicalPages                           (proc_t proc, const on_NtFreeUserPhysicalPages_fn& on_func);
        opt<id_t> register_NtFreeVirtualMemory                               (proc_t proc, const on_NtFreeVirtualMemory_fn& on_func);
        opt<id_t> register_NtFreezeRegistry                                  (proc_t proc, const on_NtFreezeRegistry_fn& on_func);
        opt<id_t> register_NtFreezeTransactions                              (proc_t proc, const on_NtFreezeTransactions_fn& on_func);
        opt<id_t> register_NtFsControlFile                                   (proc_t proc, const on_NtFsControlFile_fn& on_func);
        opt<id_t> register_NtGetContextThread                                (proc_t proc, const on_NtGetContextThread_fn& on_func);
        opt<id_t> register_NtGetDevicePowerState                             (proc_t proc, const on_NtGetDevicePowerState_fn& on_func);
        opt<id_t> register_NtGetMUIRegistryInfo                              (proc_t proc, const on_NtGetMUIRegistryInfo_fn& on_func);
        opt<id_t> register_NtGetNextProcess                                  (proc_t proc, const on_NtGetNextProcess_fn& on_func);
        opt<id_t> register_NtGetNextThread                                   (proc_t proc, const on_NtGetNextThread_fn& on_func);
        opt<id_t> register_NtGetNlsSectionPtr                                (proc_t proc, const on_NtGetNlsSectionPtr_fn& on_func);
        opt<id_t> register_NtGetNotificationResourceManager                  (proc_t proc, const on_NtGetNotificationResourceManager_fn& on_func);
        opt<id_t> register_NtGetPlugPlayEvent                                (proc_t proc, const on_NtGetPlugPlayEvent_fn& on_func);
        opt<id_t> register_NtGetWriteWatch                                   (proc_t proc, const on_NtGetWriteWatch_fn& on_func);
        opt<id_t> register_NtImpersonateAnonymousToken                       (proc_t proc, const on_NtImpersonateAnonymousToken_fn& on_func);
        opt<id_t> register_NtImpersonateClientOfPort                         (proc_t proc, const on_NtImpersonateClientOfPort_fn& on_func);
        opt<id_t> register_NtImpersonateThread                               (proc_t proc, const on_NtImpersonateThread_fn& on_func);
        opt<id_t> register_NtInitializeNlsFiles                              (proc_t proc, const on_NtInitializeNlsFiles_fn& on_func);
        opt<id_t> register_NtInitializeRegistry                              (proc_t proc, const on_NtInitializeRegistry_fn& on_func);
        opt<id_t> register_NtInitiatePowerAction                             (proc_t proc, const on_NtInitiatePowerAction_fn& on_func);
        opt<id_t> register_NtIsProcessInJob                                  (proc_t proc, const on_NtIsProcessInJob_fn& on_func);
        opt<id_t> register_NtListenPort                                      (proc_t proc, const on_NtListenPort_fn& on_func);
        opt<id_t> register_NtLoadDriver                                      (proc_t proc, const on_NtLoadDriver_fn& on_func);
        opt<id_t> register_NtLoadKey2                                        (proc_t proc, const on_NtLoadKey2_fn& on_func);
        opt<id_t> register_NtLoadKeyEx                                       (proc_t proc, const on_NtLoadKeyEx_fn& on_func);
        opt<id_t> register_NtLoadKey                                         (proc_t proc, const on_NtLoadKey_fn& on_func);
        opt<id_t> register_NtLockFile                                        (proc_t proc, const on_NtLockFile_fn& on_func);
        opt<id_t> register_NtLockProductActivationKeys                       (proc_t proc, const on_NtLockProductActivationKeys_fn& on_func);
        opt<id_t> register_NtLockRegistryKey                                 (proc_t proc, const on_NtLockRegistryKey_fn& on_func);
        opt<id_t> register_NtLockVirtualMemory                               (proc_t proc, const on_NtLockVirtualMemory_fn& on_func);
        opt<id_t> register_NtMakePermanentObject                             (proc_t proc, const on_NtMakePermanentObject_fn& on_func);
        opt<id_t> register_NtMakeTemporaryObject                             (proc_t proc, const on_NtMakeTemporaryObject_fn& on_func);
        opt<id_t> register_NtMapCMFModule                                    (proc_t proc, const on_NtMapCMFModule_fn& on_func);
        opt<id_t> register_NtMapUserPhysicalPages                            (proc_t proc, const on_NtMapUserPhysicalPages_fn& on_func);
        opt<id_t> register_NtMapUserPhysicalPagesScatter                     (proc_t proc, const on_NtMapUserPhysicalPagesScatter_fn& on_func);
        opt<id_t> register_NtMapViewOfSection                                (proc_t proc, const on_NtMapViewOfSection_fn& on_func);
        opt<id_t> register_NtModifyBootEntry                                 (proc_t proc, const on_NtModifyBootEntry_fn& on_func);
        opt<id_t> register_NtModifyDriverEntry                               (proc_t proc, const on_NtModifyDriverEntry_fn& on_func);
        opt<id_t> register_NtNotifyChangeDirectoryFile                       (proc_t proc, const on_NtNotifyChangeDirectoryFile_fn& on_func);
        opt<id_t> register_NtNotifyChangeKey                                 (proc_t proc, const on_NtNotifyChangeKey_fn& on_func);
        opt<id_t> register_NtNotifyChangeMultipleKeys                        (proc_t proc, const on_NtNotifyChangeMultipleKeys_fn& on_func);
        opt<id_t> register_NtNotifyChangeSession                             (proc_t proc, const on_NtNotifyChangeSession_fn& on_func);
        opt<id_t> register_NtOpenDirectoryObject                             (proc_t proc, const on_NtOpenDirectoryObject_fn& on_func);
        opt<id_t> register_NtOpenEnlistment                                  (proc_t proc, const on_NtOpenEnlistment_fn& on_func);
        opt<id_t> register_NtOpenEvent                                       (proc_t proc, const on_NtOpenEvent_fn& on_func);
        opt<id_t> register_NtOpenEventPair                                   (proc_t proc, const on_NtOpenEventPair_fn& on_func);
        opt<id_t> register_NtOpenFile                                        (proc_t proc, const on_NtOpenFile_fn& on_func);
        opt<id_t> register_NtOpenIoCompletion                                (proc_t proc, const on_NtOpenIoCompletion_fn& on_func);
        opt<id_t> register_NtOpenJobObject                                   (proc_t proc, const on_NtOpenJobObject_fn& on_func);
        opt<id_t> register_NtOpenKeyedEvent                                  (proc_t proc, const on_NtOpenKeyedEvent_fn& on_func);
        opt<id_t> register_NtOpenKeyEx                                       (proc_t proc, const on_NtOpenKeyEx_fn& on_func);
        opt<id_t> register_NtOpenKey                                         (proc_t proc, const on_NtOpenKey_fn& on_func);
        opt<id_t> register_NtOpenKeyTransactedEx                             (proc_t proc, const on_NtOpenKeyTransactedEx_fn& on_func);
        opt<id_t> register_NtOpenKeyTransacted                               (proc_t proc, const on_NtOpenKeyTransacted_fn& on_func);
        opt<id_t> register_NtOpenMutant                                      (proc_t proc, const on_NtOpenMutant_fn& on_func);
        opt<id_t> register_NtOpenObjectAuditAlarm                            (proc_t proc, const on_NtOpenObjectAuditAlarm_fn& on_func);
        opt<id_t> register_NtOpenPrivateNamespace                            (proc_t proc, const on_NtOpenPrivateNamespace_fn& on_func);
        opt<id_t> register_NtOpenProcess                                     (proc_t proc, const on_NtOpenProcess_fn& on_func);
        opt<id_t> register_NtOpenProcessTokenEx                              (proc_t proc, const on_NtOpenProcessTokenEx_fn& on_func);
        opt<id_t> register_NtOpenProcessToken                                (proc_t proc, const on_NtOpenProcessToken_fn& on_func);
        opt<id_t> register_NtOpenResourceManager                             (proc_t proc, const on_NtOpenResourceManager_fn& on_func);
        opt<id_t> register_NtOpenSection                                     (proc_t proc, const on_NtOpenSection_fn& on_func);
        opt<id_t> register_NtOpenSemaphore                                   (proc_t proc, const on_NtOpenSemaphore_fn& on_func);
        opt<id_t> register_NtOpenSession                                     (proc_t proc, const on_NtOpenSession_fn& on_func);
        opt<id_t> register_NtOpenSymbolicLinkObject                          (proc_t proc, const on_NtOpenSymbolicLinkObject_fn& on_func);
        opt<id_t> register_NtOpenThread                                      (proc_t proc, const on_NtOpenThread_fn& on_func);
        opt<id_t> register_NtOpenThreadTokenEx                               (proc_t proc, const on_NtOpenThreadTokenEx_fn& on_func);
        opt<id_t> register_NtOpenThreadToken                                 (proc_t proc, const on_NtOpenThreadToken_fn& on_func);
        opt<id_t> register_NtOpenTimer                                       (proc_t proc, const on_NtOpenTimer_fn& on_func);
        opt<id_t> register_NtOpenTransactionManager                          (proc_t proc, const on_NtOpenTransactionManager_fn& on_func);
        opt<id_t> register_NtOpenTransaction                                 (proc_t proc, const on_NtOpenTransaction_fn& on_func);
        opt<id_t> register_NtPlugPlayControl                                 (proc_t proc, const on_NtPlugPlayControl_fn& on_func);
        opt<id_t> register_NtPowerInformation                                (proc_t proc, const on_NtPowerInformation_fn& on_func);
        opt<id_t> register_NtPrepareComplete                                 (proc_t proc, const on_NtPrepareComplete_fn& on_func);
        opt<id_t> register_NtPrepareEnlistment                               (proc_t proc, const on_NtPrepareEnlistment_fn& on_func);
        opt<id_t> register_NtPrePrepareComplete                              (proc_t proc, const on_NtPrePrepareComplete_fn& on_func);
        opt<id_t> register_NtPrePrepareEnlistment                            (proc_t proc, const on_NtPrePrepareEnlistment_fn& on_func);
        opt<id_t> register_NtPrivilegeCheck                                  (proc_t proc, const on_NtPrivilegeCheck_fn& on_func);
        opt<id_t> register_NtPrivilegedServiceAuditAlarm                     (proc_t proc, const on_NtPrivilegedServiceAuditAlarm_fn& on_func);
        opt<id_t> register_NtPrivilegeObjectAuditAlarm                       (proc_t proc, const on_NtPrivilegeObjectAuditAlarm_fn& on_func);
        opt<id_t> register_NtPropagationComplete                             (proc_t proc, const on_NtPropagationComplete_fn& on_func);
        opt<id_t> register_NtPropagationFailed                               (proc_t proc, const on_NtPropagationFailed_fn& on_func);
        opt<id_t> register_NtProtectVirtualMemory                            (proc_t proc, const on_NtProtectVirtualMemory_fn& on_func);
        opt<id_t> register_NtPulseEvent                                      (proc_t proc, const on_NtPulseEvent_fn& on_func);
        opt<id_t> register_NtQueryAttributesFile                             (proc_t proc, const on_NtQueryAttributesFile_fn& on_func);
        opt<id_t> register_NtQueryBootEntryOrder                             (proc_t proc, const on_NtQueryBootEntryOrder_fn& on_func);
        opt<id_t> register_NtQueryBootOptions                                (proc_t proc, const on_NtQueryBootOptions_fn& on_func);
        opt<id_t> register_NtQueryDebugFilterState                           (proc_t proc, const on_NtQueryDebugFilterState_fn& on_func);
        opt<id_t> register_NtQueryDefaultLocale                              (proc_t proc, const on_NtQueryDefaultLocale_fn& on_func);
        opt<id_t> register_NtQueryDefaultUILanguage                          (proc_t proc, const on_NtQueryDefaultUILanguage_fn& on_func);
        opt<id_t> register_NtQueryDirectoryFile                              (proc_t proc, const on_NtQueryDirectoryFile_fn& on_func);
        opt<id_t> register_NtQueryDirectoryObject                            (proc_t proc, const on_NtQueryDirectoryObject_fn& on_func);
        opt<id_t> register_NtQueryDriverEntryOrder                           (proc_t proc, const on_NtQueryDriverEntryOrder_fn& on_func);
        opt<id_t> register_NtQueryEaFile                                     (proc_t proc, const on_NtQueryEaFile_fn& on_func);
        opt<id_t> register_NtQueryEvent                                      (proc_t proc, const on_NtQueryEvent_fn& on_func);
        opt<id_t> register_NtQueryFullAttributesFile                         (proc_t proc, const on_NtQueryFullAttributesFile_fn& on_func);
        opt<id_t> register_NtQueryInformationAtom                            (proc_t proc, const on_NtQueryInformationAtom_fn& on_func);
        opt<id_t> register_NtQueryInformationEnlistment                      (proc_t proc, const on_NtQueryInformationEnlistment_fn& on_func);
        opt<id_t> register_NtQueryInformationFile                            (proc_t proc, const on_NtQueryInformationFile_fn& on_func);
        opt<id_t> register_NtQueryInformationJobObject                       (proc_t proc, const on_NtQueryInformationJobObject_fn& on_func);
        opt<id_t> register_NtQueryInformationPort                            (proc_t proc, const on_NtQueryInformationPort_fn& on_func);
        opt<id_t> register_NtQueryInformationProcess                         (proc_t proc, const on_NtQueryInformationProcess_fn& on_func);
        opt<id_t> register_NtQueryInformationResourceManager                 (proc_t proc, const on_NtQueryInformationResourceManager_fn& on_func);
        opt<id_t> register_NtQueryInformationThread                          (proc_t proc, const on_NtQueryInformationThread_fn& on_func);
        opt<id_t> register_NtQueryInformationToken                           (proc_t proc, const on_NtQueryInformationToken_fn& on_func);
        opt<id_t> register_NtQueryInformationTransaction                     (proc_t proc, const on_NtQueryInformationTransaction_fn& on_func);
        opt<id_t> register_NtQueryInformationTransactionManager              (proc_t proc, const on_NtQueryInformationTransactionManager_fn& on_func);
        opt<id_t> register_NtQueryInformationWorkerFactory                   (proc_t proc, const on_NtQueryInformationWorkerFactory_fn& on_func);
        opt<id_t> register_NtQueryInstallUILanguage                          (proc_t proc, const on_NtQueryInstallUILanguage_fn& on_func);
        opt<id_t> register_NtQueryIntervalProfile                            (proc_t proc, const on_NtQueryIntervalProfile_fn& on_func);
        opt<id_t> register_NtQueryIoCompletion                               (proc_t proc, const on_NtQueryIoCompletion_fn& on_func);
        opt<id_t> register_NtQueryKey                                        (proc_t proc, const on_NtQueryKey_fn& on_func);
        opt<id_t> register_NtQueryLicenseValue                               (proc_t proc, const on_NtQueryLicenseValue_fn& on_func);
        opt<id_t> register_NtQueryMultipleValueKey                           (proc_t proc, const on_NtQueryMultipleValueKey_fn& on_func);
        opt<id_t> register_NtQueryMutant                                     (proc_t proc, const on_NtQueryMutant_fn& on_func);
        opt<id_t> register_NtQueryObject                                     (proc_t proc, const on_NtQueryObject_fn& on_func);
        opt<id_t> register_NtQueryOpenSubKeysEx                              (proc_t proc, const on_NtQueryOpenSubKeysEx_fn& on_func);
        opt<id_t> register_NtQueryOpenSubKeys                                (proc_t proc, const on_NtQueryOpenSubKeys_fn& on_func);
        opt<id_t> register_NtQueryPerformanceCounter                         (proc_t proc, const on_NtQueryPerformanceCounter_fn& on_func);
        opt<id_t> register_NtQueryQuotaInformationFile                       (proc_t proc, const on_NtQueryQuotaInformationFile_fn& on_func);
        opt<id_t> register_NtQuerySection                                    (proc_t proc, const on_NtQuerySection_fn& on_func);
        opt<id_t> register_NtQuerySecurityAttributesToken                    (proc_t proc, const on_NtQuerySecurityAttributesToken_fn& on_func);
        opt<id_t> register_NtQuerySecurityObject                             (proc_t proc, const on_NtQuerySecurityObject_fn& on_func);
        opt<id_t> register_NtQuerySemaphore                                  (proc_t proc, const on_NtQuerySemaphore_fn& on_func);
        opt<id_t> register_NtQuerySymbolicLinkObject                         (proc_t proc, const on_NtQuerySymbolicLinkObject_fn& on_func);
        opt<id_t> register_NtQuerySystemEnvironmentValueEx                   (proc_t proc, const on_NtQuerySystemEnvironmentValueEx_fn& on_func);
        opt<id_t> register_NtQuerySystemEnvironmentValue                     (proc_t proc, const on_NtQuerySystemEnvironmentValue_fn& on_func);
        opt<id_t> register_NtQuerySystemInformationEx                        (proc_t proc, const on_NtQuerySystemInformationEx_fn& on_func);
        opt<id_t> register_NtQuerySystemInformation                          (proc_t proc, const on_NtQuerySystemInformation_fn& on_func);
        opt<id_t> register_NtQuerySystemTime                                 (proc_t proc, const on_NtQuerySystemTime_fn& on_func);
        opt<id_t> register_NtQueryTimer                                      (proc_t proc, const on_NtQueryTimer_fn& on_func);
        opt<id_t> register_NtQueryTimerResolution                            (proc_t proc, const on_NtQueryTimerResolution_fn& on_func);
        opt<id_t> register_NtQueryValueKey                                   (proc_t proc, const on_NtQueryValueKey_fn& on_func);
        opt<id_t> register_NtQueryVirtualMemory                              (proc_t proc, const on_NtQueryVirtualMemory_fn& on_func);
        opt<id_t> register_NtQueryVolumeInformationFile                      (proc_t proc, const on_NtQueryVolumeInformationFile_fn& on_func);
        opt<id_t> register_NtQueueApcThreadEx                                (proc_t proc, const on_NtQueueApcThreadEx_fn& on_func);
        opt<id_t> register_NtQueueApcThread                                  (proc_t proc, const on_NtQueueApcThread_fn& on_func);
        opt<id_t> register_NtRaiseException                                  (proc_t proc, const on_NtRaiseException_fn& on_func);
        opt<id_t> register_NtRaiseHardError                                  (proc_t proc, const on_NtRaiseHardError_fn& on_func);
        opt<id_t> register_NtReadFile                                        (proc_t proc, const on_NtReadFile_fn& on_func);
        opt<id_t> register_NtReadFileScatter                                 (proc_t proc, const on_NtReadFileScatter_fn& on_func);
        opt<id_t> register_NtReadOnlyEnlistment                              (proc_t proc, const on_NtReadOnlyEnlistment_fn& on_func);
        opt<id_t> register_NtReadRequestData                                 (proc_t proc, const on_NtReadRequestData_fn& on_func);
        opt<id_t> register_NtReadVirtualMemory                               (proc_t proc, const on_NtReadVirtualMemory_fn& on_func);
        opt<id_t> register_NtRecoverEnlistment                               (proc_t proc, const on_NtRecoverEnlistment_fn& on_func);
        opt<id_t> register_NtRecoverResourceManager                          (proc_t proc, const on_NtRecoverResourceManager_fn& on_func);
        opt<id_t> register_NtRecoverTransactionManager                       (proc_t proc, const on_NtRecoverTransactionManager_fn& on_func);
        opt<id_t> register_NtRegisterProtocolAddressInformation              (proc_t proc, const on_NtRegisterProtocolAddressInformation_fn& on_func);
        opt<id_t> register_NtRegisterThreadTerminatePort                     (proc_t proc, const on_NtRegisterThreadTerminatePort_fn& on_func);
        opt<id_t> register_NtReleaseKeyedEvent                               (proc_t proc, const on_NtReleaseKeyedEvent_fn& on_func);
        opt<id_t> register_NtReleaseMutant                                   (proc_t proc, const on_NtReleaseMutant_fn& on_func);
        opt<id_t> register_NtReleaseSemaphore                                (proc_t proc, const on_NtReleaseSemaphore_fn& on_func);
        opt<id_t> register_NtReleaseWorkerFactoryWorker                      (proc_t proc, const on_NtReleaseWorkerFactoryWorker_fn& on_func);
        opt<id_t> register_NtRemoveIoCompletionEx                            (proc_t proc, const on_NtRemoveIoCompletionEx_fn& on_func);
        opt<id_t> register_NtRemoveIoCompletion                              (proc_t proc, const on_NtRemoveIoCompletion_fn& on_func);
        opt<id_t> register_NtRemoveProcessDebug                              (proc_t proc, const on_NtRemoveProcessDebug_fn& on_func);
        opt<id_t> register_NtRenameKey                                       (proc_t proc, const on_NtRenameKey_fn& on_func);
        opt<id_t> register_NtRenameTransactionManager                        (proc_t proc, const on_NtRenameTransactionManager_fn& on_func);
        opt<id_t> register_NtReplaceKey                                      (proc_t proc, const on_NtReplaceKey_fn& on_func);
        opt<id_t> register_NtReplacePartitionUnit                            (proc_t proc, const on_NtReplacePartitionUnit_fn& on_func);
        opt<id_t> register_NtReplyPort                                       (proc_t proc, const on_NtReplyPort_fn& on_func);
        opt<id_t> register_NtReplyWaitReceivePortEx                          (proc_t proc, const on_NtReplyWaitReceivePortEx_fn& on_func);
        opt<id_t> register_NtReplyWaitReceivePort                            (proc_t proc, const on_NtReplyWaitReceivePort_fn& on_func);
        opt<id_t> register_NtReplyWaitReplyPort                              (proc_t proc, const on_NtReplyWaitReplyPort_fn& on_func);
        opt<id_t> register_NtRequestPort                                     (proc_t proc, const on_NtRequestPort_fn& on_func);
        opt<id_t> register_NtRequestWaitReplyPort                            (proc_t proc, const on_NtRequestWaitReplyPort_fn& on_func);
        opt<id_t> register_NtResetEvent                                      (proc_t proc, const on_NtResetEvent_fn& on_func);
        opt<id_t> register_NtResetWriteWatch                                 (proc_t proc, const on_NtResetWriteWatch_fn& on_func);
        opt<id_t> register_NtRestoreKey                                      (proc_t proc, const on_NtRestoreKey_fn& on_func);
        opt<id_t> register_NtResumeProcess                                   (proc_t proc, const on_NtResumeProcess_fn& on_func);
        opt<id_t> register_NtResumeThread                                    (proc_t proc, const on_NtResumeThread_fn& on_func);
        opt<id_t> register_NtRollbackComplete                                (proc_t proc, const on_NtRollbackComplete_fn& on_func);
        opt<id_t> register_NtRollbackEnlistment                              (proc_t proc, const on_NtRollbackEnlistment_fn& on_func);
        opt<id_t> register_NtRollbackTransaction                             (proc_t proc, const on_NtRollbackTransaction_fn& on_func);
        opt<id_t> register_NtRollforwardTransactionManager                   (proc_t proc, const on_NtRollforwardTransactionManager_fn& on_func);
        opt<id_t> register_NtSaveKeyEx                                       (proc_t proc, const on_NtSaveKeyEx_fn& on_func);
        opt<id_t> register_NtSaveKey                                         (proc_t proc, const on_NtSaveKey_fn& on_func);
        opt<id_t> register_NtSaveMergedKeys                                  (proc_t proc, const on_NtSaveMergedKeys_fn& on_func);
        opt<id_t> register_NtSecureConnectPort                               (proc_t proc, const on_NtSecureConnectPort_fn& on_func);
        opt<id_t> register_NtSetBootEntryOrder                               (proc_t proc, const on_NtSetBootEntryOrder_fn& on_func);
        opt<id_t> register_NtSetBootOptions                                  (proc_t proc, const on_NtSetBootOptions_fn& on_func);
        opt<id_t> register_NtSetContextThread                                (proc_t proc, const on_NtSetContextThread_fn& on_func);
        opt<id_t> register_NtSetDebugFilterState                             (proc_t proc, const on_NtSetDebugFilterState_fn& on_func);
        opt<id_t> register_NtSetDefaultHardErrorPort                         (proc_t proc, const on_NtSetDefaultHardErrorPort_fn& on_func);
        opt<id_t> register_NtSetDefaultLocale                                (proc_t proc, const on_NtSetDefaultLocale_fn& on_func);
        opt<id_t> register_NtSetDefaultUILanguage                            (proc_t proc, const on_NtSetDefaultUILanguage_fn& on_func);
        opt<id_t> register_NtSetDriverEntryOrder                             (proc_t proc, const on_NtSetDriverEntryOrder_fn& on_func);
        opt<id_t> register_NtSetEaFile                                       (proc_t proc, const on_NtSetEaFile_fn& on_func);
        opt<id_t> register_NtSetEventBoostPriority                           (proc_t proc, const on_NtSetEventBoostPriority_fn& on_func);
        opt<id_t> register_NtSetEvent                                        (proc_t proc, const on_NtSetEvent_fn& on_func);
        opt<id_t> register_NtSetHighEventPair                                (proc_t proc, const on_NtSetHighEventPair_fn& on_func);
        opt<id_t> register_NtSetHighWaitLowEventPair                         (proc_t proc, const on_NtSetHighWaitLowEventPair_fn& on_func);
        opt<id_t> register_NtSetInformationDebugObject                       (proc_t proc, const on_NtSetInformationDebugObject_fn& on_func);
        opt<id_t> register_NtSetInformationEnlistment                        (proc_t proc, const on_NtSetInformationEnlistment_fn& on_func);
        opt<id_t> register_NtSetInformationFile                              (proc_t proc, const on_NtSetInformationFile_fn& on_func);
        opt<id_t> register_NtSetInformationJobObject                         (proc_t proc, const on_NtSetInformationJobObject_fn& on_func);
        opt<id_t> register_NtSetInformationKey                               (proc_t proc, const on_NtSetInformationKey_fn& on_func);
        opt<id_t> register_NtSetInformationObject                            (proc_t proc, const on_NtSetInformationObject_fn& on_func);
        opt<id_t> register_NtSetInformationProcess                           (proc_t proc, const on_NtSetInformationProcess_fn& on_func);
        opt<id_t> register_NtSetInformationResourceManager                   (proc_t proc, const on_NtSetInformationResourceManager_fn& on_func);
        opt<id_t> register_NtSetInformationThread                            (proc_t proc, const on_NtSetInformationThread_fn& on_func);
        opt<id_t> register_NtSetInformationToken                             (proc_t proc, const on_NtSetInformationToken_fn& on_func);
        opt<id_t> register_NtSetInformationTransaction                       (proc_t proc, const on_NtSetInformationTransaction_fn& on_func);
        opt<id_t> register_NtSetInformationTransactionManager                (proc_t proc, const on_NtSetInformationTransactionManager_fn& on_func);
        opt<id_t> register_NtSetInformationWorkerFactory                     (proc_t proc, const on_NtSetInformationWorkerFactory_fn& on_func);
        opt<id_t> register_NtSetIntervalProfile                              (proc_t proc, const on_NtSetIntervalProfile_fn& on_func);
        opt<id_t> register_NtSetIoCompletionEx                               (proc_t proc, const on_NtSetIoCompletionEx_fn& on_func);
        opt<id_t> register_NtSetIoCompletion                                 (proc_t proc, const on_NtSetIoCompletion_fn& on_func);
        opt<id_t> register_NtSetLdtEntries                                   (proc_t proc, const on_NtSetLdtEntries_fn& on_func);
        opt<id_t> register_NtSetLowEventPair                                 (proc_t proc, const on_NtSetLowEventPair_fn& on_func);
        opt<id_t> register_NtSetLowWaitHighEventPair                         (proc_t proc, const on_NtSetLowWaitHighEventPair_fn& on_func);
        opt<id_t> register_NtSetQuotaInformationFile                         (proc_t proc, const on_NtSetQuotaInformationFile_fn& on_func);
        opt<id_t> register_NtSetSecurityObject                               (proc_t proc, const on_NtSetSecurityObject_fn& on_func);
        opt<id_t> register_NtSetSystemEnvironmentValueEx                     (proc_t proc, const on_NtSetSystemEnvironmentValueEx_fn& on_func);
        opt<id_t> register_NtSetSystemEnvironmentValue                       (proc_t proc, const on_NtSetSystemEnvironmentValue_fn& on_func);
        opt<id_t> register_NtSetSystemInformation                            (proc_t proc, const on_NtSetSystemInformation_fn& on_func);
        opt<id_t> register_NtSetSystemPowerState                             (proc_t proc, const on_NtSetSystemPowerState_fn& on_func);
        opt<id_t> register_NtSetSystemTime                                   (proc_t proc, const on_NtSetSystemTime_fn& on_func);
        opt<id_t> register_NtSetThreadExecutionState                         (proc_t proc, const on_NtSetThreadExecutionState_fn& on_func);
        opt<id_t> register_NtSetTimerEx                                      (proc_t proc, const on_NtSetTimerEx_fn& on_func);
        opt<id_t> register_NtSetTimer                                        (proc_t proc, const on_NtSetTimer_fn& on_func);
        opt<id_t> register_NtSetTimerResolution                              (proc_t proc, const on_NtSetTimerResolution_fn& on_func);
        opt<id_t> register_NtSetUuidSeed                                     (proc_t proc, const on_NtSetUuidSeed_fn& on_func);
        opt<id_t> register_NtSetValueKey                                     (proc_t proc, const on_NtSetValueKey_fn& on_func);
        opt<id_t> register_NtSetVolumeInformationFile                        (proc_t proc, const on_NtSetVolumeInformationFile_fn& on_func);
        opt<id_t> register_NtShutdownSystem                                  (proc_t proc, const on_NtShutdownSystem_fn& on_func);
        opt<id_t> register_NtShutdownWorkerFactory                           (proc_t proc, const on_NtShutdownWorkerFactory_fn& on_func);
        opt<id_t> register_NtSignalAndWaitForSingleObject                    (proc_t proc, const on_NtSignalAndWaitForSingleObject_fn& on_func);
        opt<id_t> register_NtSinglePhaseReject                               (proc_t proc, const on_NtSinglePhaseReject_fn& on_func);
        opt<id_t> register_NtStartProfile                                    (proc_t proc, const on_NtStartProfile_fn& on_func);
        opt<id_t> register_NtStopProfile                                     (proc_t proc, const on_NtStopProfile_fn& on_func);
        opt<id_t> register_NtSuspendProcess                                  (proc_t proc, const on_NtSuspendProcess_fn& on_func);
        opt<id_t> register_NtSuspendThread                                   (proc_t proc, const on_NtSuspendThread_fn& on_func);
        opt<id_t> register_NtSystemDebugControl                              (proc_t proc, const on_NtSystemDebugControl_fn& on_func);
        opt<id_t> register_NtTerminateJobObject                              (proc_t proc, const on_NtTerminateJobObject_fn& on_func);
        opt<id_t> register_NtTerminateProcess                                (proc_t proc, const on_NtTerminateProcess_fn& on_func);
        opt<id_t> register_NtTerminateThread                                 (proc_t proc, const on_NtTerminateThread_fn& on_func);
        opt<id_t> register_NtTraceControl                                    (proc_t proc, const on_NtTraceControl_fn& on_func);
        opt<id_t> register_NtTraceEvent                                      (proc_t proc, const on_NtTraceEvent_fn& on_func);
        opt<id_t> register_NtTranslateFilePath                               (proc_t proc, const on_NtTranslateFilePath_fn& on_func);
        opt<id_t> register_NtUnloadDriver                                    (proc_t proc, const on_NtUnloadDriver_fn& on_func);
        opt<id_t> register_NtUnloadKey2                                      (proc_t proc, const on_NtUnloadKey2_fn& on_func);
        opt<id_t> register_NtUnloadKeyEx                                     (proc_t proc, const on_NtUnloadKeyEx_fn& on_func);
        opt<id_t> register_NtUnloadKey                                       (proc_t proc, const on_NtUnloadKey_fn& on_func);
        opt<id_t> register_NtUnlockFile                                      (proc_t proc, const on_NtUnlockFile_fn& on_func);
        opt<id_t> register_NtUnlockVirtualMemory                             (proc_t proc, const on_NtUnlockVirtualMemory_fn& on_func);
        opt<id_t> register_NtUnmapViewOfSection                              (proc_t proc, const on_NtUnmapViewOfSection_fn& on_func);
        opt<id_t> register_NtVdmControl                                      (proc_t proc, const on_NtVdmControl_fn& on_func);
        opt<id_t> register_NtWaitForDebugEvent                               (proc_t proc, const on_NtWaitForDebugEvent_fn& on_func);
        opt<id_t> register_NtWaitForKeyedEvent                               (proc_t proc, const on_NtWaitForKeyedEvent_fn& on_func);
        opt<id_t> register_NtWaitForMultipleObjects32                        (proc_t proc, const on_NtWaitForMultipleObjects32_fn& on_func);
        opt<id_t> register_NtWaitForMultipleObjects                          (proc_t proc, const on_NtWaitForMultipleObjects_fn& on_func);
        opt<id_t> register_NtWaitForSingleObject                             (proc_t proc, const on_NtWaitForSingleObject_fn& on_func);
        opt<id_t> register_NtWaitForWorkViaWorkerFactory                     (proc_t proc, const on_NtWaitForWorkViaWorkerFactory_fn& on_func);
        opt<id_t> register_NtWaitHighEventPair                               (proc_t proc, const on_NtWaitHighEventPair_fn& on_func);
        opt<id_t> register_NtWaitLowEventPair                                (proc_t proc, const on_NtWaitLowEventPair_fn& on_func);
        opt<id_t> register_NtWorkerFactoryWorkerReady                        (proc_t proc, const on_NtWorkerFactoryWorkerReady_fn& on_func);
        opt<id_t> register_NtWriteFileGather                                 (proc_t proc, const on_NtWriteFileGather_fn& on_func);
        opt<id_t> register_NtWriteFile                                       (proc_t proc, const on_NtWriteFile_fn& on_func);
        opt<id_t> register_NtWriteRequestData                                (proc_t proc, const on_NtWriteRequestData_fn& on_func);
        opt<id_t> register_NtWriteVirtualMemory                              (proc_t proc, const on_NtWriteVirtualMemory_fn& on_func);
        opt<id_t> register_NtDisableLastKnownGood                            (proc_t proc, const on_NtDisableLastKnownGood_fn& on_func);
        opt<id_t> register_NtEnableLastKnownGood                             (proc_t proc, const on_NtEnableLastKnownGood_fn& on_func);
        opt<id_t> register_NtFlushProcessWriteBuffers                        (proc_t proc, const on_NtFlushProcessWriteBuffers_fn& on_func);
        opt<id_t> register_NtFlushWriteBuffer                                (proc_t proc, const on_NtFlushWriteBuffer_fn& on_func);
        opt<id_t> register_NtGetCurrentProcessorNumber                       (proc_t proc, const on_NtGetCurrentProcessorNumber_fn& on_func);
        opt<id_t> register_NtIsSystemResumeAutomatic                         (proc_t proc, const on_NtIsSystemResumeAutomatic_fn& on_func);
        opt<id_t> register_NtIsUILanguageComitted                            (proc_t proc, const on_NtIsUILanguageComitted_fn& on_func);
        opt<id_t> register_NtQueryPortInformationProcess                     (proc_t proc, const on_NtQueryPortInformationProcess_fn& on_func);
        opt<id_t> register_NtSerializeBoot                                   (proc_t proc, const on_NtSerializeBoot_fn& on_func);
        opt<id_t> register_NtTestAlert                                       (proc_t proc, const on_NtTestAlert_fn& on_func);
        opt<id_t> register_NtThawRegistry                                    (proc_t proc, const on_NtThawRegistry_fn& on_func);
        opt<id_t> register_NtThawTransactions                                (proc_t proc, const on_NtThawTransactions_fn& on_func);
        opt<id_t> register_NtUmsThreadYield                                  (proc_t proc, const on_NtUmsThreadYield_fn& on_func);
        opt<id_t> register_NtYieldExecution                                  (proc_t proc, const on_NtYieldExecution_fn& on_func);

        struct Data;
        std::unique_ptr<Data> d_;
    };
} // namespace nt64
